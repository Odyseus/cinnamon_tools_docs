<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>xlets_settings.SettingsWidgets &mdash; Cinnamon Tools  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/cinnamon-logo.svg"/>
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: False" >
            <a href="../../index.html" class="icon icon-home"> Cinnamon Tools
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../includes/00-requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../includes/01-usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../includes/02-theme.html">Themes development/building</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../includes/03-tips-and-tricks.html">Cinnamon tips and tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../includes/04-development-notes.html">Development notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../includes/05-code-styling.html">Code styling/guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../includes/06-EOL.html"><abbr title="end-of-life">EOL</abbr> ideas/plans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../includes/07-xlets-settings-custom-framework.html">Xlets settings custom framework</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: False" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Cinnamon Tools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
          <li><a href="../xlets_settings.html">xlets_settings</a> &raquo;</li>
      <li>xlets_settings.SettingsWidgets</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for xlets_settings.SettingsWidgets</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;Settings widgets.</span>

<span class="sd">Attributes</span>
<span class="sd">----------</span>
<span class="sd">CAN_BACKEND : list</span>
<span class="sd">    List of widgets that can be used to control settings.</span>
<span class="sd">gsettings_objects : dict</span>
<span class="sd">    Storage for instantiated :py:class:`Gio.Settings` instances.</span>
<span class="sd">JSON_SETTINGS_PROPERTIES_MAP : dict</span>
<span class="sd">    JSON attribute to Python keywords argument map used by the settings widgets.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">gi</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">gi</span><span class="o">.</span><span class="n">require_version</span><span class="p">(</span><span class="s2">&quot;Gtk&quot;</span><span class="p">,</span> <span class="s2">&quot;3.0&quot;</span><span class="p">)</span>
<span class="n">gi</span><span class="o">.</span><span class="n">require_version</span><span class="p">(</span><span class="s2">&quot;Gdk&quot;</span><span class="p">,</span> <span class="s2">&quot;3.0&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">gi.repository</span> <span class="kn">import</span> <span class="n">GLib</span>
<span class="kn">from</span> <span class="nn">gi.repository</span> <span class="kn">import</span> <span class="n">GObject</span>
<span class="kn">from</span> <span class="nn">gi.repository</span> <span class="kn">import</span> <span class="n">Gdk</span>
<span class="kn">from</span> <span class="nn">gi.repository</span> <span class="kn">import</span> <span class="n">Gio</span>
<span class="kn">from</span> <span class="nn">gi.repository</span> <span class="kn">import</span> <span class="n">Gtk</span>
<span class="kn">from</span> <span class="nn">gi.repository</span> <span class="kn">import</span> <span class="n">Pango</span>

<span class="kn">from</span> <span class="nn">.IconChooserWidgets</span> <span class="kn">import</span> <span class="n">IconChooserButton</span>
<span class="kn">from</span> <span class="nn">.KeybindingWidgets</span> <span class="kn">import</span> <span class="n">ButtonKeybinding</span>
<span class="kn">from</span> <span class="nn">.common</span> <span class="kn">import</span> <span class="n">BaseGrid</span>
<span class="kn">from</span> <span class="nn">.common</span> <span class="kn">import</span> <span class="n">IntelligentGtkDialog</span>
<span class="kn">from</span> <span class="nn">.common</span> <span class="kn">import</span> <span class="n">_</span>
<span class="kn">from</span> <span class="nn">.common</span> <span class="kn">import</span> <span class="n">display_message_dialog</span>
<span class="kn">from</span> <span class="nn">.common</span> <span class="kn">import</span> <span class="n">get_global</span>
<span class="kn">from</span> <span class="nn">.common</span> <span class="kn">import</span> <span class="n">get_toplevel_window</span>

<span class="c1"># NOTE: JEESH!!! I hate import *!!!</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Button&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ButtonsGroup&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CAN_BACKEND&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ColorChooser&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ComboBox&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Entry&quot;</span><span class="p">,</span>
    <span class="s2">&quot;FileChooser&quot;</span><span class="p">,</span>
    <span class="s2">&quot;gsettings_objects&quot;</span><span class="p">,</span>
    <span class="s2">&quot;IconChooser&quot;</span><span class="p">,</span>
    <span class="s2">&quot;JSON_SETTINGS_PROPERTIES_MAP&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Keybinding&quot;</span><span class="p">,</span>
    <span class="s2">&quot;KeybindingWithOptions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Range&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SettingsLabel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SettingsPage&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SettingsRevealer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SettingsSection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SettingsStack&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SettingsWidget&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SoundFileChooser&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SpinButton&quot;</span><span class="p">,</span>
    <span class="s2">&quot;StringsList&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Switch&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Text&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TextView&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TextViewButton&quot;</span><span class="p">,</span>
    <span class="c1"># &quot;DateChooser&quot;,</span>
    <span class="c1"># &quot;EffectChooser&quot;,</span>
    <span class="c1"># &quot;FontButton&quot;,</span>
    <span class="c1"># &quot;TweenChooser&quot;,</span>
<span class="p">]</span>


<span class="n">JSON_SETTINGS_PROPERTIES_MAP</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># All widgets.</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;label&quot;</span><span class="p">,</span>
    <span class="c1"># spinbutton: Minimum value.</span>
    <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="s2">&quot;mini&quot;</span><span class="p">,</span>
    <span class="c1"># spinbutton: Maximum value.</span>
    <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="s2">&quot;maxi&quot;</span><span class="p">,</span>
    <span class="c1"># spinbutton: Adjustment amount.</span>
    <span class="s2">&quot;step&quot;</span><span class="p">:</span> <span class="s2">&quot;step&quot;</span><span class="p">,</span>
    <span class="c1"># spinbutton: Adjustment amount when using the Page Up/Down keys.</span>
    <span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="s2">&quot;page&quot;</span><span class="p">,</span>
    <span class="c1"># spinbutton: How many digits to handle.</span>
    <span class="s2">&quot;digits&quot;</span><span class="p">:</span> <span class="s2">&quot;digits&quot;</span><span class="p">,</span>
    <span class="c1"># spinbutton: Unit type description.</span>
    <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;units&quot;</span><span class="p">,</span>
    <span class="c1"># scale: Show value on the widget.</span>
    <span class="s2">&quot;show-value&quot;</span><span class="p">:</span> <span class="s2">&quot;show_value&quot;</span><span class="p">,</span>
    <span class="c1"># scale: Set a custom label to display as a minimum value.</span>
    <span class="s2">&quot;min-label&quot;</span><span class="p">:</span> <span class="s2">&quot;min_label&quot;</span><span class="p">,</span>
    <span class="c1"># scale: Set a custom label to display as a maximum value.</span>
    <span class="s2">&quot;max-label&quot;</span><span class="p">:</span> <span class="s2">&quot;max_label&quot;</span><span class="p">,</span>
    <span class="c1"># scale:</span>
    <span class="s2">&quot;invert&quot;</span><span class="p">:</span> <span class="s2">&quot;invert&quot;</span><span class="p">,</span>
    <span class="c1"># scale:</span>
    <span class="s2">&quot;marks&quot;</span><span class="p">:</span> <span class="s2">&quot;marks&quot;</span><span class="p">,</span>
    <span class="c1"># filechooser: If true, enable folder selection of the file chooser. If false,</span>
    <span class="c1"># enable file selection.</span>
    <span class="s2">&quot;select-dir&quot;</span><span class="p">:</span> <span class="s2">&quot;dir_select&quot;</span><span class="p">,</span>
    <span class="c1"># filechooser: A dictionary of filter labels mapped to a list of file patterns.</span>
    <span class="s2">&quot;pattern-filters&quot;</span><span class="p">:</span> <span class="s2">&quot;pattern_filters&quot;</span><span class="p">,</span>
    <span class="c1"># filechooser: A dictionary of filter labels mapped to a list of file MIME types.</span>
    <span class="s2">&quot;mimetype-filters&quot;</span><span class="p">:</span> <span class="s2">&quot;mimetype_filters&quot;</span><span class="p">,</span>
    <span class="c1"># textview: The height of the textview.</span>
    <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="s2">&quot;height&quot;</span><span class="p">,</span>
    <span class="c1"># All widgets.</span>
    <span class="s2">&quot;tooltip&quot;</span><span class="p">:</span> <span class="s2">&quot;tooltip&quot;</span><span class="p">,</span>
    <span class="c1"># possible: List of effect name.</span>
    <span class="s2">&quot;possible&quot;</span><span class="p">:</span> <span class="s2">&quot;possible&quot;</span><span class="p">,</span>
    <span class="c1"># entry and iconfilechooser: If true, expand the widget to all available space.</span>
    <span class="s2">&quot;expand-width&quot;</span><span class="p">:</span> <span class="s2">&quot;expand_width&quot;</span><span class="p">,</span>
    <span class="c1"># list: Columns definition.</span>
    <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="s2">&quot;columns&quot;</span><span class="p">,</span>
    <span class="c1"># soundfilechooser: If True, only wav and ogg sound files will be filtered in</span>
    <span class="c1"># the file chooser dialog. If set to False, all sound files will be displayed.</span>
    <span class="s2">&quot;event-sounds&quot;</span><span class="p">:</span> <span class="s2">&quot;event_sounds&quot;</span><span class="p">,</span>
    <span class="c1"># list: Whether to display or not the the Up/Down buttons.</span>
    <span class="s2">&quot;move-buttons&quot;</span><span class="p">:</span> <span class="s2">&quot;move_buttons&quot;</span><span class="p">,</span>
    <span class="c1"># list: The default width of the Edit entry dialog.</span>
    <span class="s2">&quot;dialog-width&quot;</span><span class="p">:</span> <span class="s2">&quot;dialog_width&quot;</span><span class="p">,</span>
    <span class="c1"># list: Allow multiple rows selection.</span>
    <span class="s2">&quot;multi-select&quot;</span><span class="p">:</span> <span class="s2">&quot;multi_select&quot;</span><span class="p">,</span>
    <span class="c1"># list: Whether to close the settings window after applying.</span>
    <span class="s2">&quot;apply-and-quit&quot;</span><span class="p">:</span> <span class="s2">&quot;apply_and_quit&quot;</span><span class="p">,</span>
    <span class="c1"># keybinding: Expose the number of keybindings to create.</span>
    <span class="s2">&quot;num-bind&quot;</span><span class="p">:</span> <span class="s2">&quot;num_bind&quot;</span><span class="p">,</span>
    <span class="c1"># label: Whether to use markup.</span>
    <span class="s2">&quot;use-markup&quot;</span><span class="p">:</span> <span class="s2">&quot;use_markup&quot;</span><span class="p">,</span>
    <span class="c1"># label: Whether to make the label selectable to be able to copy text.</span>
    <span class="s2">&quot;selectable&quot;</span><span class="p">:</span> <span class="s2">&quot;selectable&quot;</span><span class="p">,</span>
    <span class="c1"># list: An array of strings to be added as labels to the add/edit entry.</span>
    <span class="s2">&quot;dialog-info-labels&quot;</span><span class="p">:</span> <span class="s2">&quot;dialog_info_labels&quot;</span><span class="p">,</span>
    <span class="c1"># colorchooser: Whether to be able to specify opacity.</span>
    <span class="s2">&quot;use-alpha&quot;</span><span class="p">:</span> <span class="s2">&quot;use_alpha&quot;</span><span class="p">,</span>
    <span class="c1"># list: A dictionary that can be empty and accepts one key called ``read-only-keys``.</span>
    <span class="c1"># A list of column IDs whose created widgets should be set as nonsensitive.</span>
    <span class="c1"># An immutable list widget has a fixed amount of items.</span>
    <span class="c1"># Items cannot be added nor removed but they do can be edited.</span>
    <span class="s2">&quot;immutable&quot;</span><span class="p">:</span> <span class="s2">&quot;immutable&quot;</span><span class="p">,</span>
    <span class="c1"># textview: Whether the Tab key inserts a tab character (accept-tabs = true)</span>
    <span class="c1"># or the keyboard focus is moved (accept-tabs = false).</span>
    <span class="s2">&quot;accept-tabs&quot;</span><span class="p">:</span> <span class="s2">&quot;accept_tabs&quot;</span><span class="p">,</span>
    <span class="c1"># combobox: Explicit value type to convert an option key to.</span>
    <span class="s2">&quot;valtype&quot;</span><span class="p">:</span> <span class="s2">&quot;valtype&quot;</span><span class="p">,</span>
    <span class="c1"># combobox: A key from the &quot;options&quot; key for comboboxes. This key will be excluded from</span>
    <span class="c1"># the sorting of options and will appear always at the top of the combobox.</span>
    <span class="c1"># NOTE: Not passed as widget argument. Kept here just to keep it documented.</span>
    <span class="c1"># &quot;first-option&quot;: &quot;first_option&quot;,</span>
    <span class="c1"># button: Image for a button.</span>
    <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="s2">&quot;image&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">CAN_BACKEND</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Button&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ColorChooser&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ComboBox&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Entry&quot;</span><span class="p">,</span>
    <span class="s2">&quot;FileChooser&quot;</span><span class="p">,</span>
    <span class="s2">&quot;IconChooser&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Keybinding&quot;</span><span class="p">,</span>
    <span class="s2">&quot;KeybindingWithOptions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Range&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SoundFileChooser&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SpinButton&quot;</span><span class="p">,</span>
    <span class="s2">&quot;StringsList&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Switch&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TextView&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TextViewButton&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TreeList&quot;</span><span class="p">,</span>
    <span class="c1"># &quot;DateChooser&quot;,</span>
    <span class="c1"># &quot;EffectChooser&quot;,</span>
    <span class="c1"># &quot;FontButton&quot;,</span>
    <span class="c1"># &quot;TweenChooser&quot;,</span>
<span class="p">]</span>

<span class="n">gsettings_objects</span> <span class="o">=</span> <span class="p">{}</span>


<div class="viewcode-block" id="SettingsStack"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsStack">[docs]</a><span class="k">class</span> <span class="nc">SettingsStack</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Stack</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The stack used to switch xlets instances.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    expand : bool</span>
<span class="sd">        Expand.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_transition_type</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">StackTransitionType</span><span class="o">.</span><span class="n">SLIDE_LEFT_RIGHT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_transition_duration</span><span class="p">(</span><span class="mi">150</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expand</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="SettingsPage"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsPage">[docs]</a><span class="k">class</span> <span class="nc">SettingsPage</span><span class="p">(</span><span class="n">BaseGrid</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Settings sections holder.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_spacing</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="c1"># NOTE: Set property to avoid calling 2 methods.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s2">&quot;expand&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># NOTE: Set property to avoid calling 4 methods.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s2">&quot;margin&quot;</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_border_width</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<div class="viewcode-block" id="SettingsPage.add_section"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsPage.add_section">[docs]</a>    <span class="k">def</span> <span class="nf">add_section</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">section_info</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;Add section to page.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        title : None, optional</span>
<span class="sd">            Section title.</span>
<span class="sd">        subtitle : None, optional</span>
<span class="sd">            Section subtitle.</span>
<span class="sd">        section_info : dict, optional</span>
<span class="sd">            See :any:`SettingsWidgets.SettingsSection`, &quot;section_info&quot;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SettingsWidgets.SettingsSection</span>
<span class="sd">            The settings section.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">section</span> <span class="o">=</span> <span class="n">SettingsSection</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">subtitle</span><span class="p">,</span> <span class="n">section_info</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">section</span></div>

<div class="viewcode-block" id="SettingsPage.add_reveal_section"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsPage.add_reveal_section">[docs]</a>    <span class="k">def</span> <span class="nf">add_reveal_section</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">section_info</span><span class="o">=</span><span class="p">{},</span>
                           <span class="n">schema</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pref_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">revealer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add reveal section to page.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        title : None, optional</span>
<span class="sd">            Section title.</span>
<span class="sd">        subtitle : None, optional</span>
<span class="sd">            Section subtitle.</span>
<span class="sd">        section_info : dict, optional</span>
<span class="sd">            See :any:`SettingsWidgets.SettingsSection`.</span>
<span class="sd">        schema : None, optional</span>
<span class="sd">            See :any:`SettingsRevealer`.</span>
<span class="sd">        pref_key : None, optional</span>
<span class="sd">            See :any:`SettingsRevealer`.</span>
<span class="sd">        values : None, optional</span>
<span class="sd">            See :any:`SettingsRevealer`.</span>
<span class="sd">        revealer : None, optional</span>
<span class="sd">            The revealer that will be attached to the section and to which the widget will</span>
<span class="sd">            be attached to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SettingsWidgets.SettingsSection</span>
<span class="sd">            The settings section.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">section</span> <span class="o">=</span> <span class="n">SettingsSection</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">subtitle</span><span class="p">,</span> <span class="n">section_info</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">revealer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">revealer</span> <span class="o">=</span> <span class="n">SettingsRevealer</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">pref_key</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>

        <span class="n">revealer</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
        <span class="n">section</span><span class="o">.</span><span class="n">_revealer</span> <span class="o">=</span> <span class="n">revealer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">revealer</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">section</span></div></div>


<div class="viewcode-block" id="SettingsSection"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsSection">[docs]</a><span class="k">class</span> <span class="nc">SettingsSection</span><span class="p">(</span><span class="n">BaseGrid</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Settings section.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    always_show : bool</span>
<span class="sd">        Always show.</span>
<span class="sd">    box : BaseGrid</span>
<span class="sd">        An instance of ``BaseGrid`` that will contain all widgets in a section.</span>
<span class="sd">    frame : Gtk.Frame</span>
<span class="sd">        An instance of ``Gtk.Frame`` that will contain self.box for aesthetic purposes.</span>
<span class="sd">    need_separator : bool</span>
<span class="sd">        Flag that indicates if there is a need to insert a separator after a widget.</span>
<span class="sd">    revealers : list</span>
<span class="sd">        A list were to store a created :py:class:`Gtk.Revealer` inside a section.</span>
<span class="sd">    size_group : Gtk.SizeGroup</span>
<span class="sd">        A ``Gtk.SizeGroup``.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">section_info</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        title : None, optional</span>
<span class="sd">            Section title.</span>
<span class="sd">        subtitle : None, optional</span>
<span class="sd">            Section subtitle.</span>
<span class="sd">        section_info : dict, optional</span>
<span class="sd">            Data used to create a button at the end of the section title that opens a dialog.</span>
<span class="sd">            The dictionary can contain two keys. The &quot;context&quot; key can have one of three values</span>
<span class="sd">            (&quot;information&quot; (default), &quot;error&quot; or &quot;warning&quot;) and it will be used to decide which icon</span>
<span class="sd">            the button will have. And a &quot;message&quot; key that will store the text in valid markup</span>
<span class="sd">            that will be used on the displayed message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_spacing</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">always_show</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">revealers</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">title</span> <span class="ow">or</span> <span class="n">subtitle</span><span class="p">:</span>
            <span class="n">header_box</span> <span class="o">=</span> <span class="n">BaseGrid</span><span class="p">()</span>
            <span class="n">header_box</span><span class="o">.</span><span class="n">set_spacing</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">header_box</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Label</span><span class="p">()</span>
                <span class="n">label</span><span class="o">.</span><span class="n">set_line_wrap</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">label</span><span class="o">.</span><span class="n">set_line_wrap_mode</span><span class="p">(</span><span class="n">Pango</span><span class="o">.</span><span class="n">WrapMode</span><span class="o">.</span><span class="n">WORD</span><span class="p">)</span>
                <span class="n">label</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">label</span><span class="o">.</span><span class="n">set_markup</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;b&gt;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&lt;/b&gt;&quot;</span><span class="p">)</span>
                <span class="n">label</span><span class="o">.</span><span class="n">set_xalign</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                <span class="n">header_box</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">section_info</span><span class="p">:</span>
                    <span class="n">button</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new_from_icon_name</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;dialog-</span><span class="si">{</span><span class="n">section_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;context&quot;</span><span class="p">,</span> <span class="s2">&quot;information&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">-symbolic&#39;</span><span class="p">,</span>
                        <span class="n">Gtk</span><span class="o">.</span><span class="n">IconSize</span><span class="o">.</span><span class="n">BUTTON</span>
                    <span class="p">))</span>
                    <span class="c1"># Mark for deletion on EOL. Gtk4</span>
                    <span class="c1"># Stop using set_relief and set the boolean property has-frame.</span>
                    <span class="n">button</span><span class="o">.</span><span class="n">set_relief</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">ReliefStyle</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
                    <span class="n">button</span><span class="o">.</span><span class="n">set_always_show_image</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">button</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Information related to this specific section&quot;</span><span class="p">))</span>
                    <span class="n">button</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;clicked&quot;</span><span class="p">,</span> <span class="n">display_message_dialog</span><span class="p">,</span>
                                   <span class="n">title</span><span class="p">,</span> <span class="n">section_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;message&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                                   <span class="n">section_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;context&quot;</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">))</span>
                    <span class="n">header_box</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">button</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">subtitle</span><span class="p">:</span>
                <span class="n">sub</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Label</span><span class="p">()</span>
                <span class="n">sub</span><span class="o">.</span><span class="n">set_line_wrap</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">sub</span><span class="o">.</span><span class="n">set_line_wrap_mode</span><span class="p">(</span><span class="n">Pango</span><span class="o">.</span><span class="n">WrapMode</span><span class="o">.</span><span class="n">WORD</span><span class="p">)</span>
                <span class="n">sub</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">subtitle</span><span class="p">)</span>
                <span class="c1"># Mark for deletion on EOL. Gtk4</span>
                <span class="c1"># Replace Gtk.StyleContext.add_class with Gtk.Widget.add_css_class.</span>
                <span class="n">sub</span><span class="o">.</span><span class="n">get_style_context</span><span class="p">()</span><span class="o">.</span><span class="n">add_class</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">STYLE_CLASS_DIM_LABEL</span><span class="p">)</span>
                <span class="n">sub</span><span class="o">.</span><span class="n">set_xalign</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                <span class="n">header_box</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">sub</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Frame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">set_no_show_all</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Mark for deletion on EOL. Gtk4</span>
        <span class="c1"># Stop using set_shadow_type and set the boolean property has-frame.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">set_shadow_type</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">ShadowType</span><span class="o">.</span><span class="n">IN</span><span class="p">)</span>
        <span class="c1"># Mark for deletion on EOL. Gtk4</span>
        <span class="c1"># Replace Gtk.StyleContext.add_class with Gtk.Widget.add_css_class.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">get_style_context</span><span class="p">()</span><span class="o">.</span><span class="n">add_class</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">STYLE_CLASS_VIEW</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">size_group</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">SizeGroup</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size_group</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">SizeGroupMode</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">box</span> <span class="o">=</span> <span class="n">BaseGrid</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">need_separator</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="SettingsSection.add_row"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsSection.add_row">[docs]</a>    <span class="k">def</span> <span class="nf">add_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">col_pos</span><span class="p">,</span> <span class="n">row_pos</span><span class="p">,</span> <span class="n">col_span</span><span class="p">,</span> <span class="n">row_span</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a row to the section.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        widget : Gtk.Widget</span>
<span class="sd">            Widget to insert in a section row.</span>
<span class="sd">        col_pos : int</span>
<span class="sd">            At which column to insert a widget.</span>
<span class="sd">        row_pos : int</span>
<span class="sd">            At which row to insert a widget.</span>
<span class="sd">        col_span : int</span>
<span class="sd">            How many columns a widget will occupy.</span>
<span class="sd">        row_span : int</span>
<span class="sd">            How many rows a widget will occupy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">list_box</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ListBox</span><span class="p">(</span><span class="n">can_focus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">list_box</span><span class="o">.</span><span class="n">set_selection_mode</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">SelectionMode</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ListBoxRow</span><span class="p">(</span><span class="n">can_focus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">row</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">need_separator</span><span class="p">:</span>
            <span class="n">list_box</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Orientation</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="p">(</span><span class="n">Switch</span><span class="p">,</span> <span class="n">ColorChooser</span><span class="p">)):</span>
            <span class="n">list_box</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;row-activated&quot;</span><span class="p">,</span> <span class="n">widget</span><span class="o">.</span><span class="n">clicked</span><span class="p">)</span>

        <span class="c1"># NOTE: I was forced to use this condition because it was impossible for</span>
        <span class="c1"># the content of the TextView to be edited. It was necessary to triple</span>
        <span class="c1"># click it to gain access to it or being focused with keyboard navigation.</span>
        <span class="c1"># With this callback set to the list_box, the TextView content can directly</span>
        <span class="c1"># be accessed with a single click.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">TextView</span><span class="p">):</span>
            <span class="n">list_box</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;row-activated&quot;</span><span class="p">,</span> <span class="n">widget</span><span class="o">.</span><span class="n">focus_the_retarded_text_view</span><span class="p">)</span>

        <span class="n">list_box</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">list_box</span><span class="p">,</span> <span class="n">col_pos</span><span class="p">,</span> <span class="n">row_pos</span><span class="p">,</span> <span class="n">col_span</span><span class="p">,</span> <span class="n">row_span</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_always_show_state</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">need_separator</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="SettingsSection.add_reveal_row"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsSection.add_reveal_row">[docs]</a>    <span class="k">def</span> <span class="nf">add_reveal_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">col_pos</span><span class="p">,</span> <span class="n">row_pos</span><span class="p">,</span> <span class="n">col_span</span><span class="p">,</span> <span class="n">row_span</span><span class="p">,</span>
                       <span class="n">schema</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pref_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">check_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">revealer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a reveal row to the section.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        widget : Gtk.Widget</span>
<span class="sd">            Widget to insert in a section row.</span>
<span class="sd">        col_pos : int</span>
<span class="sd">            At which column to insert a widget.</span>
<span class="sd">        row_pos : int</span>
<span class="sd">            At which row to insert a widget.</span>
<span class="sd">        col_span : int</span>
<span class="sd">            How many columns a widget will occupy.</span>
<span class="sd">        row_span : int</span>
<span class="sd">            How many rows a widget will occupy.</span>
<span class="sd">        schema : None, optional</span>
<span class="sd">            See :any:`xlets_settings.SettingsWidgets.SettingsRevealer`.</span>
<span class="sd">        pref_key : None, optional</span>
<span class="sd">            See :any:`xlets_settings.SettingsWidgets.SettingsRevealer`.</span>
<span class="sd">        values : None, optional</span>
<span class="sd">            See :any:`xlets_settings.SettingsWidgets.SettingsRevealer`.</span>
<span class="sd">        check_func : None, optional</span>
<span class="sd">            See :any:`xlets_settings.SettingsWidgets.SettingsRevealer`.</span>
<span class="sd">        revealer : None, optional</span>
<span class="sd">            The revealer that will be attached to the section and to which the widget will</span>
<span class="sd">            be attached to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        JSONSettingsRevealer, xlets_settings.SettingsWidgets.SettingsRevealer</span>
<span class="sd">            The revealer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">list_box</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ListBox</span><span class="p">(</span><span class="n">can_focus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">list_box</span><span class="o">.</span><span class="n">set_selection_mode</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">SelectionMode</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">need_separator</span><span class="p">:</span>
            <span class="n">list_box</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Orientation</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">))</span>

        <span class="n">row</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ListBoxRow</span><span class="p">(</span><span class="n">can_focus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">row</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="p">(</span><span class="n">Switch</span><span class="p">,</span> <span class="n">ColorChooser</span><span class="p">)):</span>
            <span class="n">list_box</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;row-activated&quot;</span><span class="p">,</span> <span class="n">widget</span><span class="o">.</span><span class="n">clicked</span><span class="p">)</span>

        <span class="n">list_box</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">revealer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">revealer</span> <span class="o">=</span> <span class="n">SettingsRevealer</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">pref_key</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">check_func</span><span class="p">)</span>

        <span class="n">widget</span><span class="o">.</span><span class="n">revealer</span> <span class="o">=</span> <span class="n">revealer</span>
        <span class="n">revealer</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">list_box</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">revealer</span><span class="p">,</span> <span class="n">col_pos</span><span class="p">,</span> <span class="n">row_pos</span><span class="p">,</span> <span class="n">col_span</span><span class="p">,</span> <span class="n">row_span</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">need_separator</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">revealers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">revealer</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">always_show</span><span class="p">:</span>
            <span class="n">revealer</span><span class="o">.</span><span class="n">notify_id</span> <span class="o">=</span> <span class="n">revealer</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;notify::child-revealed&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_reveal_state</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_reveal_state</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">revealer</span></div>

<div class="viewcode-block" id="SettingsSection.add_note"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsSection.add_note">[docs]</a>    <span class="k">def</span> <span class="nf">add_note</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a note to a section.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        text : str</span>
<span class="sd">            The note text.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Gtk.Label</span>
<span class="sd">            The note to add to a section.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Label</span><span class="p">()</span>
        <span class="n">label</span><span class="o">.</span><span class="n">set_line_wrap</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">set_line_wrap_mode</span><span class="p">(</span><span class="n">Pango</span><span class="o">.</span><span class="n">WrapMode</span><span class="o">.</span><span class="n">WORD</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">set_xalign</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">set_markup</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">set_line_wrap</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">label</span></div>

<div class="viewcode-block" id="SettingsSection.update_always_show_state"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsSection.update_always_show_state">[docs]</a>    <span class="k">def</span> <span class="nf">update_always_show_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update always show state.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            Halt execution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">always_show</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">set_no_show_all</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">show_all</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">always_show</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">for</span> <span class="n">revealer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">revealers</span><span class="p">:</span>
            <span class="n">revealer</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="n">revealer</span><span class="o">.</span><span class="n">notify_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="SettingsSection.check_reveal_state"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsSection.check_reveal_state">[docs]</a>    <span class="k">def</span> <span class="nf">check_reveal_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check reveal state.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            Halt execution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">revealer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">revealers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">revealer</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">child_revealed</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">show_all</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="SettingsRevealer"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsRevealer">[docs]</a><span class="k">class</span> <span class="nc">SettingsRevealer</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Revealer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Settings revealer widget.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    box : BaseGrid</span>
<span class="sd">        An instance of ``BaseGrid`` that will contain all widgets inside a revealer.</span>
<span class="sd">    check_func : method</span>
<span class="sd">        A function that when executed will return the condition that will decide</span>
<span class="sd">        if the revealer is shown or hidden. It receives two arguments. The first argument is</span>
<span class="sd">        the current value of the pref_key preference. The second argument is a list of values</span>
<span class="sd">        that could be used to check the current value against.</span>
<span class="sd">    settings : Gio.Settings</span>
<span class="sd">        A ``Gio.Settings`` instance.</span>
<span class="sd">    values : list</span>
<span class="sd">        See :any:`SettingsRevealer.check_func`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pref_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">check_func</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        schema : None, optional</span>
<span class="sd">            gsettings schema used to instantiate :any:`SettingsRevealer.settings`.</span>
<span class="sd">        pref_key : None, optional</span>
<span class="sd">            The preference key whose value will determine if the revealer is shown or hidden.</span>
<span class="sd">        values : None, optional</span>
<span class="sd">            See :any:`SettingsRevealer.values`.</span>
<span class="sd">        check_func : None, optional</span>
<span class="sd">            See :any:`SettingsRevealer.check_func`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Gtk</span><span class="o">.</span><span class="n">Revealer</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">check_func</span> <span class="o">=</span> <span class="n">check_func</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">box</span> <span class="o">=</span> <span class="n">BaseGrid</span><span class="p">(</span><span class="n">spacing</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">Gtk</span><span class="o">.</span><span class="n">Revealer</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_transition_type</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">RevealerTransitionType</span><span class="o">.</span><span class="n">SLIDE_DOWN</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_transition_duration</span><span class="p">(</span><span class="mi">150</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">schema</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
            <span class="c1"># if there aren&#39;t values or a function provided to determine visibility we</span>
            <span class="c1"># can do a simple bind</span>
            <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">check_func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">pref_key</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;reveal-child&quot;</span><span class="p">,</span> <span class="n">Gio</span><span class="o">.</span><span class="n">SettingsBindFlags</span><span class="o">.</span><span class="n">GET</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;changed::</span><span class="si">{</span><span class="n">pref_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_settings_changed</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">on_settings_changed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">pref_key</span><span class="p">)</span>

<div class="viewcode-block" id="SettingsRevealer.add"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsRevealer.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add widget to revealer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        widget : Gtk.Widget</span>
<span class="sd">            The widget to add to the revealer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

    <span class="c1"># only used when checking values</span>
<div class="viewcode-block" id="SettingsRevealer.on_settings_changed"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsRevealer.on_settings_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_settings_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settings</span><span class="p">,</span> <span class="n">pref_key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function to set the revealer visibility.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        settings : Gio.Settings</span>
<span class="sd">            A ``Gio.Settings`` instance.</span>
<span class="sd">        pref_key : str</span>
<span class="sd">            The preference key whose value will determine if the revealer is shown or hidden.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">pref_key</span><span class="p">)</span><span class="o">.</span><span class="n">unpack</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_reveal_child</span><span class="p">(</span><span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_reveal_child</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">check_func</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="SettingsWidget"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsWidget">[docs]</a><span class="k">class</span> <span class="nc">SettingsWidget</span><span class="p">(</span><span class="n">BaseGrid</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Main class to generate all types of widgets (be them gsettings widgets or xlets widgets).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dep_key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dep_key : None, optional</span>
<span class="sd">            A string on the format &quot;gsettings.schema/gsetting-key&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Orientation</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_spacing</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dep_key</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_dep_key</span><span class="p">(</span><span class="n">dep_key</span><span class="p">)</span>

<div class="viewcode-block" id="SettingsWidget.set_dep_key"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsWidget.set_dep_key">[docs]</a>    <span class="k">def</span> <span class="nf">set_dep_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dep_key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set dependency key.</span>

<span class="sd">        This is used by gsettings widgets. It works by setting a widget sensitivity instead of</span>
<span class="sd">        using a revealer. dep_key is a string in the format &quot;gsettings.schema/gsetting-key&quot;.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dep_key : str</span>
<span class="sd">            A string on the format &quot;gsettings.schema/gsetting-key&quot;.</span>

<span class="sd">        TODO</span>
<span class="sd">        ----</span>
<span class="sd">        See if I can modify this mechanism to be handled exactly as the dependency keys for</span>
<span class="sd">        xlets settings. As it is it just works with booleans. @low</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">SettingsBindFlags</span><span class="o">.</span><span class="n">GET</span>
        <span class="k">if</span> <span class="n">dep_key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;!&quot;</span><span class="p">:</span>
            <span class="n">dep_key</span> <span class="o">=</span> <span class="n">dep_key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">flag</span> <span class="o">|=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">BindFlags</span><span class="o">.</span><span class="n">INVERT_BOOLEAN</span>

        <span class="n">split</span> <span class="o">=</span> <span class="n">dep_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="n">dep_settings</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">dep_settings</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">split</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;sensitive&quot;</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span></div>

<div class="viewcode-block" id="SettingsWidget.add_to_size_group"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsWidget.add_to_size_group">[docs]</a>    <span class="k">def</span> <span class="nf">add_to_size_group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add widget to A ``Gtk.SizeGroup``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        group : Gtk.SizeGroup</span>
<span class="sd">            A ``Gtk.SizeGroup``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">group</span><span class="o">.</span><span class="n">add_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="p">)</span></div>

<div class="viewcode-block" id="SettingsWidget.fill_row"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsWidget.fill_row">[docs]</a>    <span class="k">def</span> <span class="nf">fill_row</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fill row.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_border_width</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_margin_start</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_margin_end</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="SettingsWidget.get_settings"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsWidget.get_settings">[docs]</a>    <span class="k">def</span> <span class="nf">get_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :py:class:`Gio.Settings` instance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        schema : str</span>
<span class="sd">            gsettings schema.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Gio.Settings</span>
<span class="sd">            An instantiated ``Gio.Settings`` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">global</span> <span class="n">gsettings_objects</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">gsettings_objects</span><span class="p">[</span><span class="n">schema</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">gsettings_objects</span><span class="p">[</span><span class="n">schema</span><span class="p">]</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">gsettings_objects</span><span class="p">[</span><span class="n">schema</span><span class="p">]</span></div></div>


<div class="viewcode-block" id="Text"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Text">[docs]</a><span class="k">class</span> <span class="nc">Text</span><span class="p">(</span><span class="n">SettingsWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A simple widget to display informative text.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    content_widget : Gtk.Label</span>
<span class="sd">        The main widget that will be used to represent a setting value.</span>
<span class="sd">    label : str</span>
<span class="sd">        The label widget.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">START</span><span class="p">,</span> <span class="n">use_markup</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">selectable</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            The label text.</span>
<span class="sd">        align : int, optional</span>
<span class="sd">            :py:class:`Gtk.Align`.</span>
<span class="sd">        use_markup : bool, optional</span>
<span class="sd">            Whether or not to use markup in the label.</span>
<span class="sd">        selectable : bool, optional</span>
<span class="sd">            Make the :any:`Gtk.Label` widget text selectable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>

        <span class="k">if</span> <span class="n">align</span> <span class="o">==</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">END</span><span class="p">:</span>
            <span class="n">xalign</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">justification</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Justification</span><span class="o">.</span><span class="n">RIGHT</span>
        <span class="k">elif</span> <span class="n">align</span> <span class="o">==</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">CENTER</span><span class="p">:</span>
            <span class="n">xalign</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="n">justification</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Justification</span><span class="o">.</span><span class="n">CENTER</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># START and FILL align left</span>
            <span class="n">xalign</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">justification</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Justification</span><span class="o">.</span><span class="n">LEFT</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">halign</span><span class="o">=</span><span class="n">align</span><span class="p">,</span> <span class="n">xalign</span><span class="o">=</span><span class="n">xalign</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="n">justification</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_line_wrap</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_line_wrap_mode</span><span class="p">(</span><span class="n">Pango</span><span class="o">.</span><span class="n">WrapMode</span><span class="o">.</span><span class="n">WORD</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_selectable</span><span class="p">(</span><span class="n">selectable</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">use_markup</span><span class="p">:</span>
            <span class="c1"># NOTE: The label should be escaped where it is needed in the</span>
            <span class="c1"># label declaration side.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_markup</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="Button"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Button">[docs]</a><span class="k">class</span> <span class="nc">Button</span><span class="p">(</span><span class="n">SettingsWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A button widget that when pressed bill toggle a boolean preference.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    bind_dir : Gio.SettingsBindFlags, None</span>
<span class="sd">        See :any:`JSONSettingsBackend`.</span>
<span class="sd">    content_widget : Gtk.Button</span>
<span class="sd">        The main widget that will be used to represent a setting value.</span>
<span class="sd">    label : str</span>
<span class="sd">        The label widget.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bind_dir</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">for_group</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            The label text.</span>
<span class="sd">        image : str, optional</span>
<span class="sd">            An image for the button.</span>
<span class="sd">        tooltip : str, optional</span>
<span class="sd">            Widget tooltip text.</span>
<span class="sd">        for_group : bool, optional</span>
<span class="sd">            If the button is added to an instance of :any;`ButtonsGroup`, span the button widget</span>
<span class="sd">            just one column instead of two.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>

        <span class="k">if</span> <span class="n">image</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
                <span class="n">image</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new_from_icon_name</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">IconSize</span><span class="o">.</span><span class="n">BUTTON</span><span class="p">),</span>
                <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
                <span class="n">valign</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">CENTER</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">valign</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">for_group</span> <span class="k">else</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">tooltip</span><span class="p">)</span>

<div class="viewcode-block" id="Button._on_button_clicked"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Button._on_button_clicked">[docs]</a>    <span class="k">def</span> <span class="nf">_on_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;On button clicked.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">())</span></div>

<div class="viewcode-block" id="Button.set_label"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Button.set_label">[docs]</a>    <span class="k">def</span> <span class="nf">set_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set label.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            The label text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="p">)</span></div>

<div class="viewcode-block" id="Button.on_setting_changed"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Button.on_setting_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_setting_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :any:`JSONSettingsBackend.on_setting_changed`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Button.connect_widget_handlers"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Button.connect_widget_handlers">[docs]</a>    <span class="k">def</span> <span class="nf">connect_widget_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :any:`JSONSettingsBackend.connect_widget_handlers`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;clicked&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_button_clicked</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ButtonsGroup"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.ButtonsGroup">[docs]</a><span class="k">class</span> <span class="nc">ButtonsGroup</span><span class="p">(</span><span class="n">BaseGrid</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A widget used to group instances of :any:`Button`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Orientation</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_column_homogeneous</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_spacing</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span></div>


<div class="viewcode-block" id="SettingsLabel"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsLabel">[docs]</a><span class="k">class</span> <span class="nc">SettingsLabel</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Label</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A label widget that will be used as description for each created widget.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_markup</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        text : None, optional</span>
<span class="sd">            Label text.</span>
<span class="sd">        use_markup : bool, optional</span>
<span class="sd">            Whether or not to insert the text as markup.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">use_markup</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_markup</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_alignment</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_line_wrap</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_line_wrap_mode</span><span class="p">(</span><span class="n">Pango</span><span class="o">.</span><span class="n">WrapMode</span><span class="o">.</span><span class="n">WORD</span><span class="p">)</span>

<div class="viewcode-block" id="SettingsLabel.set_label_text"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsLabel.set_label_text">[docs]</a>    <span class="k">def</span> <span class="nf">set_label_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set label text.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        text : str</span>
<span class="sd">            Label text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></div>

<div class="viewcode-block" id="SettingsLabel.set_label_markup"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SettingsLabel.set_label_markup">[docs]</a>    <span class="k">def</span> <span class="nf">set_label_markup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">markup</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set label markup.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        markup : str</span>
<span class="sd">            Label markup.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_markup</span><span class="p">(</span><span class="n">markup</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="IconChooser"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.IconChooser">[docs]</a><span class="k">class</span> <span class="nc">IconChooser</span><span class="p">(</span><span class="n">SettingsWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A widget to choose named icons or icon files.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    bind_dir : Gio.SettingsBindFlags, None</span>
<span class="sd">        See :any:`JSONSettingsBackend`.</span>
<span class="sd">    bind_object : IconChooserButton</span>
<span class="sd">        See :any:`JSONSettingsBackend`.</span>
<span class="sd">    bind_prop : str</span>
<span class="sd">        See :any:`JSONSettingsBackend`.</span>
<span class="sd">    label : SettingsWidgets.SettingsLabel</span>
<span class="sd">        The label widget.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bind_prop</span> <span class="o">=</span> <span class="s2">&quot;icon&quot;</span>
    <span class="n">bind_dir</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">SettingsBindFlags</span><span class="o">.</span><span class="n">DEFAULT</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">size_group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dep_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            The label text.</span>
<span class="sd">        size_group : None, optional</span>
<span class="sd">            A ``Gtk.SizeGroup``.</span>
<span class="sd">        dep_key : None, optional</span>
<span class="sd">            See :any:`SettingsWidget.set_dep_key`.</span>
<span class="sd">        tooltip : str, optional</span>
<span class="sd">            Widget tooltip text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dep_key</span><span class="o">=</span><span class="n">dep_key</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_completion</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setting_entry_text</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">SettingsLabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

        <span class="n">icon_chooser</span> <span class="o">=</span> <span class="n">IconChooserButton</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind_object</span> <span class="o">=</span> <span class="n">icon_chooser</span><span class="o">.</span><span class="n">button</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">icon_chooser</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">tooltip</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">size_group</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_to_size_group</span><span class="p">(</span><span class="n">size_group</span><span class="p">)</span></div>


<div class="viewcode-block" id="Entry"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Entry">[docs]</a><span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">SettingsWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An editable entry to store text into a preference.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    bind_dir : Gio.SettingsBindFlags, None</span>
<span class="sd">        See :any:`JSONSettingsBackend`.</span>
<span class="sd">    bind_prop : str</span>
<span class="sd">        See :any:`JSONSettingsBackend.attach_backend`.</span>
<span class="sd">    content_widget : Gtk.Entry</span>
<span class="sd">        The main widget that will be used to represent a setting value.</span>
<span class="sd">    label : SettingsWidgets.SettingsLabel</span>
<span class="sd">        The label widget.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bind_prop</span> <span class="o">=</span> <span class="s2">&quot;text&quot;</span>
    <span class="n">bind_dir</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">SettingsBindFlags</span><span class="o">.</span><span class="n">DEFAULT</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">expand_width</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size_group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dep_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            The label text.</span>
<span class="sd">        expand_width : bool, optional</span>
<span class="sd">            If True, expand the widget to all available space.</span>
<span class="sd">        size_group : None, optional</span>
<span class="sd">            A ``Gtk.SizeGroup``.</span>
<span class="sd">        dep_key : None, optional</span>
<span class="sd">            See :any:`SettingsWidget.set_dep_key`.</span>
<span class="sd">        tooltip : str, optional</span>
<span class="sd">            Widget tooltip text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dep_key</span><span class="o">=</span><span class="n">dep_key</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">SettingsLabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">valign</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="n">expand_width</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">tooltip</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">size_group</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_to_size_group</span><span class="p">(</span><span class="n">size_group</span><span class="p">)</span></div>


<div class="viewcode-block" id="TextView"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.TextView">[docs]</a><span class="k">class</span> <span class="nc">TextView</span><span class="p">(</span><span class="n">SettingsWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An editable entry to store text in multiple lines into a preference.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    bind_dir : Gio.SettingsBindFlags, None</span>
<span class="sd">        See :any:`JSONSettingsBackend`.</span>
<span class="sd">    bind_object : Gtk.EntryBuffer</span>
<span class="sd">        See :any:`JSONSettingsBackend.attach_backend`.</span>
<span class="sd">    bind_prop : str</span>
<span class="sd">        See :any:`JSONSettingsBackend.attach_backend`.</span>
<span class="sd">    content_widget : Gtk.TextView</span>
<span class="sd">        The main widget that will be used to represent a setting value.</span>
<span class="sd">    label : SettingsWidgets.SettingsLabel</span>
<span class="sd">        The label widget.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bind_prop</span> <span class="o">=</span> <span class="s2">&quot;text&quot;</span>
    <span class="n">bind_dir</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">SettingsBindFlags</span><span class="o">.</span><span class="n">DEFAULT</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">accept_tabs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dep_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            The label text.</span>
<span class="sd">        height : int, optional</span>
<span class="sd">            Minimum list widget height.</span>
<span class="sd">        accept_tabs : bool, optional</span>
<span class="sd">            Whether the :kbd:`Tab` key inserts a tab character (accept_tabs = True)</span>
<span class="sd">            or the keyboard focus is moved (accept_tabs = False).</span>
<span class="sd">        dep_key : None, optional</span>
<span class="sd">            See :any:`SettingsWidget.set_dep_key`.</span>
<span class="sd">        tooltip : str, optional</span>
<span class="sd">            Widget tooltip text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dep_key</span><span class="o">=</span><span class="n">dep_key</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">SettingsLabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_alignment</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

        <span class="n">scrolledwindow</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ScrolledWindow</span><span class="p">(</span><span class="n">hadjustment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vadjustment</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">scrolledwindow</span><span class="o">.</span><span class="n">set_size_request</span><span class="p">(</span><span class="n">width</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">)</span>
        <span class="n">scrolledwindow</span><span class="o">.</span><span class="n">set_policy</span><span class="p">(</span><span class="n">hscrollbar_policy</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">AUTOMATIC</span><span class="p">,</span>
                                  <span class="n">vscrollbar_policy</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">AUTOMATIC</span><span class="p">)</span>
        <span class="c1"># Mark for deletion on EOL. Gtk4</span>
        <span class="c1"># Stop using set_shadow_type and set the boolean property has-frame.</span>
        <span class="n">scrolledwindow</span><span class="o">.</span><span class="n">set_shadow_type</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">ShadowType</span><span class="o">.</span><span class="n">ETCHED_IN</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">TextView</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_accepts_tab</span><span class="p">(</span><span class="n">accept_tabs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_border_width</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_wrap_mode</span><span class="p">(</span><span class="n">wrap_mode</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">WrapMode</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">get_buffer</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">scrolledwindow</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">scrolledwindow</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">tooltip</span><span class="p">)</span>

<div class="viewcode-block" id="TextView.focus_the_retarded_text_view"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.TextView.focus_the_retarded_text_view">[docs]</a>    <span class="k">def</span> <span class="nf">focus_the_retarded_text_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Focus the :py:class:`Gtk.TextView` when clicked.</span>

<span class="sd">        This is a workaround for ``Gtk.TextView`` elements.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            See :py:class:`Gdk.EVENT_STOP`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">grab_focus</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Gdk</span><span class="o">.</span><span class="n">EVENT_STOP</span></div></div>


<div class="viewcode-block" id="TextViewButton"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.TextViewButton">[docs]</a><span class="k">class</span> <span class="nc">TextViewButton</span><span class="p">(</span><span class="n">SettingsWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Same widget as :any:`TextView` but the editable entry is in its own dialog that&#39;s accessed</span>
<span class="sd">    through a button.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    accept_tabs : bool</span>
<span class="sd">        Whether the :kbd:`Tab` key inserts a tab character (accept_tabs = True)</span>
<span class="sd">        or the keyboard focus is moved (accept_tabs = False).</span>
<span class="sd">    bind_dir : Gio.SettingsBindFlags, None</span>
<span class="sd">        See :any:`JSONSettingsBackend`.</span>
<span class="sd">    content_widget : Gtk.Button</span>
<span class="sd">        The button to display the dialog with the editable entry.</span>
<span class="sd">    dialog_height : int</span>
<span class="sd">        Height of the dialog tied to the widget.</span>
<span class="sd">    dialog_width : int</span>
<span class="sd">        Width of the dialog tied to the widget.</span>
<span class="sd">    label : SettingsWidgets.SettingsLabel</span>
<span class="sd">        The label widget.</span>
<span class="sd">    textview_buffer : Gtk.TextBuffer</span>
<span class="sd">        The buffer used by the :any:`Gtk.TextView`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bind_dir</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">accept_tabs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dep_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            The widget label.</span>
<span class="sd">        accept_tabs : bool, optional</span>
<span class="sd">            Whether the :kbd:`Tab` key inserts a tab character (accept_tabs = True)</span>
<span class="sd">            or the keyboard focus is moved (accept_tabs = False).</span>
<span class="sd">        dep_key : None, optional</span>
<span class="sd">            See :any:`SettingsWidget.set_dep_key`.</span>
<span class="sd">        tooltip : str, optional</span>
<span class="sd">            Widget tooltip text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dep_key</span><span class="o">=</span><span class="n">dep_key</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialog_width</span> <span class="o">=</span> <span class="mi">500</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialog_height</span> <span class="o">=</span> <span class="mi">400</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept_tabs</span> <span class="o">=</span> <span class="n">accept_tabs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">valign</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textview_buffer</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">TextBuffer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">tooltip</span><span class="p">)</span>

<div class="viewcode-block" id="TextViewButton._open_text_view"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.TextViewButton._open_text_view">[docs]</a>    <span class="k">def</span> <span class="nf">_open_text_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open the dialog with the editable entry.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">IntelligentGtkDialog</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">transient_for</span><span class="o">=</span><span class="n">get_toplevel_window</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
            <span class="n">use_header_bar</span><span class="o">=</span><span class="n">get_global</span><span class="p">(</span><span class="s2">&quot;USE_HEADER_BARS_ON_DIALOGS&quot;</span><span class="p">),</span>
            <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
            <span class="n">flags</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">DialogFlags</span><span class="o">.</span><span class="n">MODAL</span> <span class="o">|</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">DialogFlags</span><span class="o">.</span><span class="n">DESTROY_WITH_PARENT</span><span class="p">,</span>
            <span class="n">buttons</span><span class="o">=</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;_Cancel&quot;</span><span class="p">),</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">CANCEL</span><span class="p">,</span>
                     <span class="n">_</span><span class="p">(</span><span class="s2">&quot;_Save&quot;</span><span class="p">),</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">OK</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">content_area</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">get_content_area</span><span class="p">()</span>
        <span class="n">content_area_grid</span> <span class="o">=</span> <span class="n">BaseGrid</span><span class="p">()</span>
        <span class="n">content_area</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">content_area_grid</span><span class="p">)</span>

        <span class="n">scrolled</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ScrolledWindow</span><span class="p">(</span><span class="n">hadjustment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vadjustment</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="c1"># NOTE: Set property to avoid calling 2 methods.</span>
        <span class="n">scrolled</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s2">&quot;expand&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Mark for deletion on EOL. Gtk4</span>
        <span class="c1"># Stop using set_shadow_type and set the boolean property has-frame.</span>
        <span class="n">scrolled</span><span class="o">.</span><span class="n">set_shadow_type</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">ShadowType</span><span class="o">.</span><span class="n">IN</span><span class="p">)</span>
        <span class="n">scrolled</span><span class="o">.</span><span class="n">set_policy</span><span class="p">(</span><span class="n">hscrollbar_policy</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">AUTOMATIC</span><span class="p">,</span>
                            <span class="n">vscrollbar_policy</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">AUTOMATIC</span><span class="p">)</span>
        <span class="n">content_area_grid</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">scrolled</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">textview</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">TextView</span><span class="o">.</span><span class="n">new_with_buffer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">textview_buffer</span><span class="p">)</span>
        <span class="n">textview</span><span class="o">.</span><span class="n">set_accepts_tab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">accept_tabs</span><span class="p">)</span>
        <span class="n">textview</span><span class="o">.</span><span class="n">set_border_width</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">textview</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">textview</span><span class="o">.</span><span class="n">set_wrap_mode</span><span class="p">(</span><span class="n">wrap_mode</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">WrapMode</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
        <span class="n">scrolled</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">textview</span><span class="p">)</span>

        <span class="n">current_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textview_buffer</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">current_text</span><span class="p">)</span>

        <span class="n">content_area</span><span class="o">.</span><span class="n">show_all</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">response</span> <span class="o">==</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">OK</span><span class="p">:</span>
            <span class="n">new_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textview_buffer</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">textview_buffer</span><span class="o">.</span><span class="n">get_start_iter</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">textview_buffer</span><span class="o">.</span><span class="n">get_end_iter</span><span class="p">(),</span>
                <span class="kc">True</span>  <span class="c1"># FIXME: Should I or should I not?</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">current_text</span> <span class="o">!=</span> <span class="n">new_text</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">new_text</span><span class="p">)</span>

        <span class="n">dialog</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span></div>

<div class="viewcode-block" id="TextViewButton.on_setting_changed"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.TextViewButton.on_setting_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_setting_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :any:`JSONSettingsBackend.on_setting_changed`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textview_buffer</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">())</span></div>

<div class="viewcode-block" id="TextViewButton.connect_widget_handlers"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.TextViewButton.connect_widget_handlers">[docs]</a>    <span class="k">def</span> <span class="nf">connect_widget_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :any:`JSONSettingsBackend.connect_widget_handlers`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;clicked&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_text_view</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Switch"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Switch">[docs]</a><span class="k">class</span> <span class="nc">Switch</span><span class="p">(</span><span class="n">SettingsWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A switch widget to toggle a boolean preference.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    bind_dir : Gio.SettingsBindFlags, None</span>
<span class="sd">        See :any:`JSONSettingsBackend`.</span>
<span class="sd">    bind_prop : str</span>
<span class="sd">        See :any:`JSONSettingsBackend.attach_backend`.</span>
<span class="sd">    content_widget : Gtk.Switch</span>
<span class="sd">        The main widget that will be used to represent a setting value.</span>
<span class="sd">    label : SettingsWidgets.SettingsLabel</span>
<span class="sd">        The label widget.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bind_prop</span> <span class="o">=</span> <span class="s2">&quot;active&quot;</span>
    <span class="n">bind_dir</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">SettingsBindFlags</span><span class="o">.</span><span class="n">DEFAULT</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">dep_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            The label text.</span>
<span class="sd">        dep_key : None, optional</span>
<span class="sd">            See :any:`SettingsWidget.set_dep_key`.</span>
<span class="sd">        tooltip : str, optional</span>
<span class="sd">            Widget tooltip text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dep_key</span><span class="o">=</span><span class="n">dep_key</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">SettingsLabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Switch</span><span class="p">(</span><span class="n">valign</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">tooltip</span><span class="p">)</span>

<div class="viewcode-block" id="Switch.clicked"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Switch.clicked">[docs]</a>    <span class="k">def</span> <span class="nf">clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicked.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_sensitive</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_active</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">get_active</span><span class="p">())</span></div></div>


<div class="viewcode-block" id="Range"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Range">[docs]</a><span class="k">class</span> <span class="nc">Range</span><span class="p">(</span><span class="n">SettingsWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A widget to choose a numeric value with a slider.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    bind_dir : Gio.SettingsBindFlags, None</span>
<span class="sd">        See :any:`JSONSettingsBackend`.</span>
<span class="sd">    bind_object : Gtk.Scale</span>
<span class="sd">        See :any:`JSONSettingsBackend`.</span>
<span class="sd">    bind_prop : str</span>
<span class="sd">        See :any:`JSONSettingsBackend.attach_backend`.</span>
<span class="sd">    content_widget : Gtk.Scale</span>
<span class="sd">        The main widget that will be used to represent a setting value.</span>
<span class="sd">    flipped : bool</span>
<span class="sd">        FIXME: I don&#39;t understand what this does just yet, so I didn&#39;t exposed its use.</span>
<span class="sd">    invert : bool</span>
<span class="sd">        Flip the rendering of the widget.</span>
<span class="sd">    label : Gtk.Label</span>
<span class="sd">        The label widget.</span>
<span class="sd">    log : bool</span>
<span class="sd">        FIXME: I don&#39;t understand what this does just yet, so I didn&#39;t exposed its use.</span>
<span class="sd">    map_get : function</span>
<span class="sd">        See :any:`JSONSettingsHandler.bind`.</span>
<span class="sd">    map_set : function</span>
<span class="sd">        See :any:`JSONSettingsHandler.bind`.</span>
<span class="sd">    max_label : Gtk.Label</span>
<span class="sd">        The maximum label widget text.</span>
<span class="sd">    min_label : Gtk.Label</span>
<span class="sd">        The minimum label widget text.</span>
<span class="sd">    step : int</span>
<span class="sd">        Adjustment amount.</span>
<span class="sd">    value : int</span>
<span class="sd">        Widget value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bind_prop</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span>
    <span class="n">bind_dir</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">SettingsBindFlags</span><span class="o">.</span><span class="n">GET</span> <span class="o">|</span> <span class="n">Gio</span><span class="o">.</span><span class="n">SettingsBindFlags</span><span class="o">.</span><span class="n">NO_SENSITIVITY</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">min_label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">max_label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">mini</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">invert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dep_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                 <span class="n">flipped</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">marks</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            The label widget text.</span>
<span class="sd">        min_label : str, optional</span>
<span class="sd">            The minimum label widget text.</span>
<span class="sd">        max_label : str, optional</span>
<span class="sd">            The maximum label widget text.</span>
<span class="sd">        mini : None, optional</span>
<span class="sd">            Minimum value.</span>
<span class="sd">        maxi : None, optional</span>
<span class="sd">            Maximum value.</span>
<span class="sd">        step : None, optional</span>
<span class="sd">            Adjustment amount.</span>
<span class="sd">        invert : bool, optional</span>
<span class="sd">            Flip the rendering of the widget.</span>
<span class="sd">        log : bool, optional</span>
<span class="sd">            FIXME: I don&#39;t understand what this does just yet, so I didn&#39;t exposed its use.</span>
<span class="sd">        show_value : bool, optional</span>
<span class="sd">            Display the actual value in the slider.</span>
<span class="sd">        dep_key : None, optional</span>
<span class="sd">            See :any:`SettingsWidget.set_dep_key`.</span>
<span class="sd">        tooltip : str, optional</span>
<span class="sd">            Widget tooltip text.</span>
<span class="sd">        flipped : bool, optional</span>
<span class="sd">            FIXME: I don&#39;t understand what this does just yet, so I didn&#39;t exposed its use.</span>
<span class="sd">        units : str, optional</span>
<span class="sd">            Unit type description.</span>
<span class="sd">        marks : list, optional</span>
<span class="sd">            Data to generate marks in the :any:`Gtk.Scale` widget.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dep_key</span><span class="o">=</span><span class="n">dep_key</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">log</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">invert</span> <span class="o">=</span> <span class="n">invert</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flipped</span> <span class="o">=</span> <span class="n">flipped</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">units</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">+=</span> <span class="s2">&quot; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Label</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_halign</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">min_label</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Label</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_label</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Label</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_label</span><span class="o">.</span><span class="n">set_alignment</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_label</span><span class="o">.</span><span class="n">set_alignment</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_label</span><span class="o">.</span><span class="n">set_margin_right</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_label</span><span class="o">.</span><span class="n">set_margin_left</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

        <span class="c1"># NOTE: The original implementation calls get_range to get the min and max values</span>
        <span class="c1"># defined in the settings-schema.json file. Since I mostly use generic settings, I don&#39;t</span>
        <span class="c1"># specify any properties in the settings-schema.json file for spinbuttons. Due to</span>
        <span class="c1"># this, calling get_range raises an exception. In this case, just use the mini and maxi</span>
        <span class="c1"># parameters and move on.</span>
        <span class="c1"># FIXME: Revisit and fix it.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_range</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="n">mini</span><span class="p">,</span> <span class="n">maxi</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">mini</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">maxi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mini</span> <span class="o">=</span> <span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">maxi</span> <span class="o">=</span> <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mini</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">mini</span><span class="p">,</span> <span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">maxi</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">maxi</span><span class="p">,</span> <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">log</span><span class="p">:</span>
            <span class="n">mini</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">mini</span><span class="p">)</span>
            <span class="n">maxi</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">maxi</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flipped</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">map_get</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">map_set</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">map_get</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">map_set</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">flipped</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">map_get</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">map_set</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flipped</span><span class="p">:</span>
            <span class="n">tmp_mini</span> <span class="o">=</span> <span class="n">mini</span>
            <span class="n">mini</span> <span class="o">=</span> <span class="n">maxi</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">maxi</span> <span class="o">=</span> <span class="n">tmp_mini</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">if</span> <span class="n">step</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="p">(</span><span class="n">maxi</span> <span class="o">-</span> <span class="n">mini</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.02</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="k">if</span> <span class="n">log</span> <span class="k">else</span> <span class="n">step</span>

        <span class="c1"># NOTE: min_label and max_label can be specified as null/None in the settings files</span>
        <span class="c1"># to force not to set a label. By default, the markup is always set to the min/max values.</span>
        <span class="k">if</span> <span class="n">min_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_label</span><span class="o">.</span><span class="n">set_markup</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;i&gt;&lt;small&gt;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">min_label</span> <span class="ow">or</span> <span class="n">mini</span><span class="p">)</span><span class="si">}</span><span class="s2">&lt;/small&gt;&lt;/i&gt;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">max_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_label</span><span class="o">.</span><span class="n">set_markup</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;i&gt;&lt;small&gt;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">max_label</span> <span class="ow">or</span> <span class="n">maxi</span><span class="p">)</span><span class="si">}</span><span class="s2">&lt;/small&gt;&lt;/i&gt;&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Scale</span><span class="o">.</span><span class="n">new_with_range</span><span class="p">(</span>
            <span class="n">Gtk</span><span class="o">.</span><span class="n">Orientation</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">,</span> <span class="n">mini</span><span class="p">,</span> <span class="n">maxi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_inverted</span><span class="p">(</span><span class="n">invert</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_draw_value</span><span class="p">(</span><span class="n">show_value</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">flipped</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">get_adjustment</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">marks</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">marks</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">marks</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">add_mark</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">PositionType</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">marks</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">value</span><span class="p">,</span> <span class="n">markup</span> <span class="ow">in</span> <span class="n">marks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">add_mark</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">PositionType</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">markup</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">invert</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># Gtk.Scale.new_with_range want a positive value, but our custom scroll handler wants a negative value</span>

        <span class="n">scale_container</span> <span class="o">=</span> <span class="n">BaseGrid</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Orientation</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="n">scale_container</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_label</span><span class="p">,</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">invert</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">scale_container</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">scale_container</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_label</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">invert</span> <span class="k">else</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">scale_container</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;scroll-event&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_scroll_event</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;value-changed&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_value_changed</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">log</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;change-value&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">round_value_to_step</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">tooltip</span><span class="p">)</span>

<div class="viewcode-block" id="Range.round_value_to_step"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Range.round_value_to_step">[docs]</a>    <span class="k">def</span> <span class="nf">round_value_to_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">scroll</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Round value to step.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        widget : Gtk.Scale</span>
<span class="sd">            The object which received the signal.</span>
<span class="sd">        scroll : Gdk.EventKey</span>
<span class="sd">            The ``Gdk.EventKey`` which triggered this signal.</span>
<span class="sd">        value : int</span>
<span class="sd">            The widget value.</span>
<span class="sd">        data : None, optional</span>
<span class="sd">            User data.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            FIXME: Event propagation?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">value</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Range._on_value_changed"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Range._on_value_changed">[docs]</a>    <span class="k">def</span> <span class="nf">_on_value_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;On value changed.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Remove source.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">get_value</span><span class="p">())))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flipped</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">get_value</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_timer</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">GLib</span><span class="o">.</span><span class="n">SOURCE_REMOVE</span></div>

<div class="viewcode-block" id="Range.on_value_changed"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Range.on_value_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_value_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delayed apply.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timer</span><span class="p">:</span>
            <span class="n">GLib</span><span class="o">.</span><span class="n">source_remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_timer</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_timer</span> <span class="o">=</span> <span class="n">GLib</span><span class="o">.</span><span class="n">timeout_add</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_value_changed</span><span class="p">)</span></div>

<div class="viewcode-block" id="Range.on_scroll_event"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Range.on_scroll_event">[docs]</a>    <span class="k">def</span> <span class="nf">on_scroll_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;On scroll event.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        widget : Gtk.Scale</span>
<span class="sd">            The object which received the signal.</span>
<span class="sd">        event : Gdk.EventKey</span>
<span class="sd">            The ``Gdk.EventKey`` which triggered this signal.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            FIXME: Event propagation?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">found</span><span class="p">,</span> <span class="n">delta_x</span><span class="p">,</span> <span class="n">delta_y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get_scroll_deltas</span><span class="p">()</span>

        <span class="c1"># If you scroll up, delta_y &lt; 0. This is a weird world</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">widget</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span> <span class="o">-</span> <span class="n">delta_y</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Range.add_mark"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Range.add_mark">[docs]</a>    <span class="k">def</span> <span class="nf">add_mark</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">markup</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add mark.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">            The value at which the mark is placed, must be between the lower and upper limits of \</span>
<span class="sd">            the scales’ adjustment.</span>
<span class="sd">        position : Gtk.PositionType</span>
<span class="sd">            where to draw the mark. For a horizontal scale, `Gtk.PositionType.TOP` and \</span>
<span class="sd">            `Gtk.PositionType.LEFT` are drawn above the scale, anything else below. \</span>
<span class="sd">            For a vertical scale, `Gtk.PositionType.LEFT` and `Gtk.PositionType.TOP` are drawn to \</span>
<span class="sd">            the left of the scale, anything else to the right.</span>
<span class="sd">        markup : str, None</span>
<span class="sd">            Text to be shown at the mark, using Pango markup.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">add_mark</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">position</span><span class="p">,</span> <span class="n">markup</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">add_mark</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">markup</span><span class="p">)</span></div>

<div class="viewcode-block" id="Range.set_rounding"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Range.set_rounding">[docs]</a>    <span class="k">def</span> <span class="nf">set_rounding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">digits</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set rounding.</span>

<span class="sd">        Sets the number of digits to round the value to when it changes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        digits : int</span>
<span class="sd">            The precision in digits.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_round_digits</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_digits</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ComboBox"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.ComboBox">[docs]</a><span class="k">class</span> <span class="nc">ComboBox</span><span class="p">(</span><span class="n">SettingsWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A combo box widget from which to choose any of the predefined values.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    bind_dir : Gio.SettingsBindFlags, None</span>
<span class="sd">        See :any:`JSONSettingsBackend`.</span>
<span class="sd">    content_widget : Gtk.ComboBox</span>
<span class="sd">        The main widget that will be used to represent a setting value.</span>
<span class="sd">    label : SettingsWidgets.SettingsLabel</span>
<span class="sd">        The label widget.</span>
<span class="sd">    model : Gtk.ListStore</span>
<span class="sd">        The model used as storage by this widget.</span>
<span class="sd">    value : str, int, float</span>
<span class="sd">        The preference stored value used to set the current combo box item.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bind_dir</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">[],</span> <span class="n">valtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size_group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dep_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            The label text.</span>
<span class="sd">        options : list, optional</span>
<span class="sd">            A list of tuples of two elements representing the options used to build</span>
<span class="sd">            a :any:`ComboBox` widget and its derivatives.</span>
<span class="sd">        valtype : None, optional</span>
<span class="sd">            The type used to coerce a specific option type.</span>
<span class="sd">        size_group : None, optional</span>
<span class="sd">            A ``Gtk.SizeGroup``.</span>
<span class="sd">        dep_key : None, optional</span>
<span class="sd">            See :any:`SettingsWidget.set_dep_key`.</span>
<span class="sd">        tooltip : str, optional</span>
<span class="sd">            Widget tooltip text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dep_key</span><span class="o">=</span><span class="n">dep_key</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_valtype</span> <span class="o">=</span> <span class="n">valtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_option_map</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">SettingsLabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ComboBox</span><span class="p">(</span><span class="n">valign</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
        <span class="n">renderer_text</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">CellRendererText</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">pack_start</span><span class="p">(</span><span class="n">renderer_text</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">add_attribute</span><span class="p">(</span><span class="n">renderer_text</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_options</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">tooltip</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">size_group</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_to_size_group</span><span class="p">(</span><span class="n">size_group</span><span class="p">)</span>

<div class="viewcode-block" id="ComboBox._on_combo_value_changed"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.ComboBox._on_combo_value_changed">[docs]</a>    <span class="k">def</span> <span class="nf">_on_combo_value_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;On value changed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        widget : Gtk.ComboBox</span>
<span class="sd">            The widget combo box.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tree_iter</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">get_active_iter</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">tree_iter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="n">tree_iter</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="ComboBox._set_options"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.ComboBox._set_options">[docs]</a>    <span class="k">def</span> <span class="nf">_set_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set options</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        options : list</span>
<span class="sd">            See :any:`ComboBox` ``options`` argument.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">var_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valtype</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># assume all keys are the same type (mixing types is going to cause an error somewhere)</span>
            <span class="n">var_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ListStore</span><span class="p">(</span><span class="n">var_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_option_map</span><span class="p">[</span><span class="n">var_type</span><span class="p">(</span><span class="n">option</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">[</span><span class="n">var_type</span><span class="p">(</span><span class="n">option</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">option</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_model</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_id_column</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="ComboBox.on_setting_changed"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.ComboBox.on_setting_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_setting_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :any:`JSONSettingsBackend.on_setting_changed`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_active_iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_option_map</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_active_iter</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="ComboBox.connect_widget_handlers"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.ComboBox.connect_widget_handlers">[docs]</a>    <span class="k">def</span> <span class="nf">connect_widget_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :any:`JSONSettingsBackend.connect_widget_handlers`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;changed&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_combo_value_changed</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ColorChooser"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.ColorChooser">[docs]</a><span class="k">class</span> <span class="nc">ColorChooser</span><span class="p">(</span><span class="n">SettingsWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Widget to choose a color.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    bind_dir : Gio.SettingsBindFlags, None</span>
<span class="sd">        See :any:`JSONSettingsBackend`.</span>
<span class="sd">    content_widget : Gtk.ColorButton</span>
<span class="sd">        The main widget that will be used to represent a setting value.</span>
<span class="sd">    label : SettingsWidgets.SettingsLabel</span>
<span class="sd">        The label widget.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bind_dir</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">use_alpha</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size_group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dep_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            The label text.</span>
<span class="sd">        use_alpha : bool, optional</span>
<span class="sd">            Whether the widget is be able to specify opacity.</span>
<span class="sd">        size_group : None, optional</span>
<span class="sd">            A ``Gtk.SizeGroup``.</span>
<span class="sd">        dep_key : None, optional</span>
<span class="sd">            See :any:`SettingsWidget.set_dep_key`.</span>
<span class="sd">        tooltip : str, optional</span>
<span class="sd">            Widget tooltip text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dep_key</span><span class="o">=</span><span class="n">dep_key</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">SettingsLabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">container</span> <span class="o">=</span> <span class="n">BaseGrid</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Orientation</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="n">container</span><span class="o">.</span><span class="n">set_spacing</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c1"># Mark for deletion on EOL. Gtk4</span>
        <span class="c1"># Replace Gtk.StyleContext.add_class with Gtk.Widget.add_css_class.</span>
        <span class="n">container</span><span class="o">.</span><span class="n">get_style_context</span><span class="p">()</span><span class="o">.</span><span class="n">add_class</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">STYLE_CLASS_LINKED</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_button</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new_from_icon_name</span><span class="p">(</span>
            <span class="s2">&quot;edit-clear-symbolic&quot;</span><span class="p">,</span>
            <span class="n">Gtk</span><span class="o">.</span><span class="n">IconSize</span><span class="o">.</span><span class="n">BUTTON</span>
        <span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_button</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Clear color&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ColorButton</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_use_alpha</span><span class="p">(</span><span class="n">use_alpha</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">container</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_clear_button</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">container</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">tooltip</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">size_group</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_to_size_group</span><span class="p">(</span><span class="n">size_group</span><span class="p">)</span>

<div class="viewcode-block" id="ColorChooser._on_clear_button_clicked"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.ColorChooser._on_clear_button_clicked">[docs]</a>    <span class="k">def</span> <span class="nf">_on_clear_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;On clear button clicked.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_widget_color</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ColorChooser._on_color_set"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.ColorChooser._on_color_set">[docs]</a>    <span class="k">def</span> <span class="nf">_on_color_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;On color set.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">get_rgba</span><span class="p">()</span><span class="o">.</span><span class="n">to_string</span><span class="p">())</span></div>

<div class="viewcode-block" id="ColorChooser._set_widget_color"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.ColorChooser._set_widget_color">[docs]</a>    <span class="k">def</span> <span class="nf">_set_widget_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color_string</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set widget color.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        color_string : str</span>
<span class="sd">            The string color.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># NOTE: Luckily, empty strings will set the color to white.</span>
        <span class="n">rgba</span> <span class="o">=</span> <span class="n">Gdk</span><span class="o">.</span><span class="n">RGBA</span><span class="p">()</span>
        <span class="n">rgba</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">color_string</span><span class="p">)</span>
        <span class="c1"># NOTE: set_rgba sets RGBA and RGB.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_rgba</span><span class="p">(</span><span class="n">rgba</span><span class="p">)</span></div>

<div class="viewcode-block" id="ColorChooser.clicked"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.ColorChooser.clicked">[docs]</a>    <span class="k">def</span> <span class="nf">clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;On clicked.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">do_clicked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="p">)</span></div>

<div class="viewcode-block" id="ColorChooser.on_setting_changed"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.ColorChooser.on_setting_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_setting_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :any:`JSONSettingsBackend.on_setting_changed`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_widget_color</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">())</span></div>

<div class="viewcode-block" id="ColorChooser.connect_widget_handlers"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.ColorChooser.connect_widget_handlers">[docs]</a>    <span class="k">def</span> <span class="nf">connect_widget_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :any:`JSONSettingsBackend.connect_widget_handlers`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;color-set&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_color_set</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_button</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;clicked&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_clear_button_clicked</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="FileChooser"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.FileChooser">[docs]</a><span class="k">class</span> <span class="nc">FileChooser</span><span class="p">(</span><span class="n">SettingsWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A widget to choose and store a path to a file or directory into a preference.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    bind_dir : Gio.SettingsBindFlags, None</span>
<span class="sd">        See :any:`JSONSettingsBackend`.</span>
<span class="sd">    content_widget : Gtk.Button</span>
<span class="sd">        The main widget that will be used to represent a setting value.</span>
<span class="sd">    label : SettingsWidgets.SettingsLabel</span>
<span class="sd">        The label widget.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bind_dir</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">dir_select</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">size_group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dep_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                 <span class="n">pattern_filters</span><span class="o">=</span><span class="p">{},</span> <span class="n">mimetype_filters</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            The label text.</span>
<span class="sd">        dir_select : bool, optional</span>
<span class="sd">            If True, enable folder selection on the file chooser. If False,</span>
<span class="sd">            enable file selection.</span>
<span class="sd">        size_group : None, optional</span>
<span class="sd">            A ``Gtk.SizeGroup``.</span>
<span class="sd">        dep_key : None, optional</span>
<span class="sd">            See :any:`SettingsWidget.set_dep_key`.</span>
<span class="sd">        tooltip : str, optional</span>
<span class="sd">            Widget tooltip text.</span>
<span class="sd">        pattern_filters : dict, optional</span>
<span class="sd">            Filters to add to the :any:`Gtk.FileChooserDialog`.</span>
<span class="sd">        mimetype_filters : dict, optional</span>
<span class="sd">            Filters to add to the :any:`Gtk.FileChooserDialog`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dep_key</span><span class="o">=</span><span class="n">dep_key</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dir_select</span> <span class="o">=</span> <span class="n">dir_select</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pattern_filters</span> <span class="o">=</span> <span class="n">pattern_filters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mimetype_filters</span> <span class="o">=</span> <span class="n">mimetype_filters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_content_widget_label</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">container</span> <span class="o">=</span> <span class="n">BaseGrid</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Orientation</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="n">container</span><span class="o">.</span><span class="n">set_spacing</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c1"># Mark for deletion on EOL. Gtk4</span>
        <span class="c1"># Replace Gtk.StyleContext.add_class with Gtk.Widget.add_css_class.</span>
        <span class="n">container</span><span class="o">.</span><span class="n">get_style_context</span><span class="p">()</span><span class="o">.</span><span class="n">add_class</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">STYLE_CLASS_LINKED</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">SettingsLabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_button</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
            <span class="n">image</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new_from_icon_name</span><span class="p">(</span><span class="s2">&quot;edit-clear-symbolic&quot;</span><span class="p">,</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">IconSize</span><span class="o">.</span><span class="n">BUTTON</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_button</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Clear path&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
            <span class="n">image</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new_from_icon_name</span><span class="p">(</span>
                <span class="s2">&quot;folder-open-symbolic&quot;</span> <span class="k">if</span> <span class="n">dir_select</span> <span class="k">else</span> <span class="s2">&quot;document-open-symbolic&quot;</span><span class="p">,</span>
                <span class="n">Gtk</span><span class="o">.</span><span class="n">IconSize</span><span class="o">.</span><span class="n">BUTTON</span><span class="p">),</span>
            <span class="c1"># NOTE: Initialize with an empty label.</span>
            <span class="c1"># Otherwise, I can&#39;t access it and store it in self._content_widget_label.</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
        <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Mark for deletion on EOL. Gtk4</span>
            <span class="c1"># Switch to Gtk.Widget&#39;s children APIs to access the button label.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_content_widget_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">get_image</span><span class="p">()</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span><span class="o">.</span><span class="n">get_children</span><span class="p">()[</span>
                <span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_content_widget_label</span><span class="o">.</span><span class="n">set_max_width_chars</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_content_widget_label</span><span class="o">.</span><span class="n">set_ellipsize</span><span class="p">(</span><span class="n">Pango</span><span class="o">.</span><span class="n">EllipsizeMode</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">container</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_clear_button</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">container</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">tooltip</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_button_label_and_tooltip</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">size_group</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_to_size_group</span><span class="p">(</span><span class="n">size_group</span><span class="p">)</span>

<div class="viewcode-block" id="FileChooser._update_button_label_and_tooltip"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.FileChooser._update_button_label_and_tooltip">[docs]</a>    <span class="k">def</span> <span class="nf">_update_button_label_and_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update button label and tooltip.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">GLib</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">GLib</span><span class="o">.</span><span class="n">file_test</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">GLib</span><span class="o">.</span><span class="n">FileTest</span><span class="o">.</span><span class="n">EXISTS</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span>
                        <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Non-existent file/location&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">value</span><span class="p">)</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_content_widget_label</span><span class="p">:</span>
                        <span class="c1"># Mark for deletion on EOL. Gtk4</span>
                        <span class="c1"># Replace Gtk.StyleContext.add_class with Gtk.Widget.add_css_class.</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_content_widget_label</span><span class="o">.</span><span class="n">get_style_context</span><span class="p">()</span><span class="o">.</span><span class="n">add_class</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">STYLE_CLASS_ERROR</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;(None)&quot;</span><span class="p">))</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dir_select</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Select a folder&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Select a file&quot;</span><span class="p">))</span></div>

<div class="viewcode-block" id="FileChooser._attach_filters"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.FileChooser._attach_filters">[docs]</a>    <span class="k">def</span> <span class="nf">_attach_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialog</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Attach filters to dialog.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dialog : Gtk.FileChooserDialog</span>
<span class="sd">            The dialog to which to attach filters.</span>
<span class="sd">        filter_type : str, optional</span>
<span class="sd">            One of &quot;pattern&quot; or &quot;mimetype&quot;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            Halt execution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="n">filter_type</span><span class="si">}</span><span class="s2">_filters&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">filters</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">patterns</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">filter</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">FileFilter</span><span class="p">()</span>
            <span class="nb">filter</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">patterns</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">filter_type</span> <span class="o">==</span> <span class="s2">&quot;pattern&quot;</span><span class="p">:</span>
                    <span class="nb">filter</span><span class="o">.</span><span class="n">add_pattern</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">filter</span><span class="o">.</span><span class="n">add_mime_type</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

            <span class="n">dialog</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="nb">filter</span><span class="p">)</span>

        <span class="c1"># NOTE: Always add this filter last to not make the dialog too restrictive.</span>
        <span class="nb">filter</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">FileFilter</span><span class="p">()</span>
        <span class="nb">filter</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Any files&quot;</span><span class="p">))</span>
        <span class="nb">filter</span><span class="o">.</span><span class="n">add_pattern</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="nb">filter</span><span class="p">)</span></div>

<div class="viewcode-block" id="FileChooser._on_content_widget_clicked"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.FileChooser._on_content_widget_clicked">[docs]</a>    <span class="k">def</span> <span class="nf">_on_content_widget_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;On content widget clicked.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dir_select</span><span class="p">:</span>
            <span class="n">action</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">FileChooserAction</span><span class="o">.</span><span class="n">SELECT_FOLDER</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Select a folder&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">action</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">FileChooserAction</span><span class="o">.</span><span class="n">OPEN</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Select a file&quot;</span><span class="p">)</span>

        <span class="n">dialog</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">FileChooserDialog</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
            <span class="n">action</span><span class="o">=</span><span class="n">action</span><span class="p">,</span>
            <span class="n">transient_for</span><span class="o">=</span><span class="n">get_toplevel_window</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
            <span class="n">use_header_bar</span><span class="o">=</span><span class="n">get_global</span><span class="p">(</span><span class="s2">&quot;USE_HEADER_BARS_ON_DIALOGS&quot;</span><span class="p">),</span>
            <span class="n">flags</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">DialogFlags</span><span class="o">.</span><span class="n">MODAL</span> <span class="o">|</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">DialogFlags</span><span class="o">.</span><span class="n">DESTROY_WITH_PARENT</span><span class="p">,</span>
            <span class="n">buttons</span><span class="o">=</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;_Cancel&quot;</span><span class="p">),</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">CANCEL</span><span class="p">,</span>
                     <span class="n">_</span><span class="p">(</span><span class="s2">&quot;_Select&quot;</span><span class="p">),</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">OK</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">parent_of_current_path</span> <span class="o">=</span> <span class="n">GLib</span><span class="o">.</span><span class="n">path_get_dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">GLib</span><span class="o">.</span><span class="n">file_test</span><span class="p">(</span><span class="n">parent_of_current_path</span><span class="p">,</span> <span class="n">GLib</span><span class="o">.</span><span class="n">FileTest</span><span class="o">.</span><span class="n">IS_DIR</span><span class="p">):</span>
            <span class="n">dialog</span><span class="o">.</span><span class="n">set_current_folder</span><span class="p">(</span><span class="n">parent_of_current_path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dialog</span><span class="o">.</span><span class="n">set_current_folder</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dir_select</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_attach_filters</span><span class="p">(</span><span class="n">dialog</span><span class="p">,</span> <span class="s2">&quot;pattern&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_attach_filters</span><span class="p">(</span><span class="n">dialog</span><span class="p">,</span> <span class="s2">&quot;mimetype&quot;</span><span class="p">)</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">response</span> <span class="o">==</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">OK</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">dialog</span><span class="o">.</span><span class="n">get_filename</span><span class="p">())</span>

        <span class="n">dialog</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_button_label_and_tooltip</span><span class="p">()</span></div>

<div class="viewcode-block" id="FileChooser._on_clear_button_clicked"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.FileChooser._on_clear_button_clicked">[docs]</a>    <span class="k">def</span> <span class="nf">_on_clear_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;On clear button clicked.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_button_label_and_tooltip</span><span class="p">()</span></div>

<div class="viewcode-block" id="FileChooser.on_setting_changed"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.FileChooser.on_setting_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_setting_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :any:`JSONSettingsBackend.on_setting_changed`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_button_label_and_tooltip</span><span class="p">()</span></div>

<div class="viewcode-block" id="FileChooser.connect_widget_handlers"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.FileChooser.connect_widget_handlers">[docs]</a>    <span class="k">def</span> <span class="nf">connect_widget_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :any:`JSONSettingsBackend.connect_widget_handlers`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;clicked&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_content_widget_clicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_button</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;clicked&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_clear_button_clicked</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SpinButton"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SpinButton">[docs]</a><span class="k">class</span> <span class="nc">SpinButton</span><span class="p">(</span><span class="n">SettingsWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A widget to choose and store an integer or float value into a preference.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    bind_dir : Gio.SettingsBindFlags, None</span>
<span class="sd">        See :any:`JSONSettingsBackend`.</span>
<span class="sd">    bind_prop : str</span>
<span class="sd">        See :any:`JSONSettingsBackend.attach_backend`.</span>
<span class="sd">    content_widget : Gtk.SpinButton</span>
<span class="sd">        The main widget that will be used to represent a setting value.</span>
<span class="sd">    label : SettingsWidgets.SettingsLabel</span>
<span class="sd">        The label widget.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bind_prop</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span>
    <span class="n">bind_dir</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">SettingsBindFlags</span><span class="o">.</span><span class="n">GET</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">mini</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">page</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size_group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dep_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            The label text.</span>
<span class="sd">        units : str, optional</span>
<span class="sd">            Unit type description.</span>
<span class="sd">        mini : None, optional</span>
<span class="sd">            Minimum value.</span>
<span class="sd">        maxi : None, optional</span>
<span class="sd">            Maximum value.</span>
<span class="sd">        step : int, float, optional</span>
<span class="sd">            Adjustment amount.</span>
<span class="sd">        page : None, optional</span>
<span class="sd">            Adjustment amount when using the Page Up/Down keys.</span>
<span class="sd">        size_group : None, optional</span>
<span class="sd">            A ``Gtk.SizeGroup``.</span>
<span class="sd">        dep_key : None, optional</span>
<span class="sd">            See :any:`SettingsWidget.set_dep_key`.</span>
<span class="sd">        tooltip : str, optional</span>
<span class="sd">            Widget tooltip text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dep_key</span><span class="o">=</span><span class="n">dep_key</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_timer</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">units</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; (</span><span class="si">{</span><span class="n">units</span><span class="si">}</span><span class="s2">)&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">SettingsLabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">SpinButton</span><span class="p">(</span><span class="n">valign</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># NOTE: The original implementation calls get_range to get the min and max values</span>
        <span class="c1"># defined in the settings-schema.json file. Since I mostly use generic settings, I don&#39;t</span>
        <span class="c1"># specify any properties in the settings-schema.json file for spinbuttons. Due to</span>
        <span class="c1"># this, calling get_range raises an exception. In this case, just use the mini and maxi</span>
        <span class="c1"># parameters and move on.</span>
        <span class="c1"># FIXME: Revisit and fix it.</span>
        <span class="c1"># FIXME: Another thing that I found. When a min or max value is a negative integer, the</span>
        <span class="c1"># widget saves the value as float. This could f**k up the JavaScript side of the xlet that</span>
        <span class="c1"># might expect an integer. I&#39;m thinking of reading at initialization the min or max values</span>
        <span class="c1"># type and store it to later apply it to the value that is going to be saved.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_range</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="n">mini</span><span class="p">,</span> <span class="n">maxi</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">mini</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">maxi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mini</span> <span class="o">=</span> <span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">maxi</span> <span class="o">=</span> <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mini</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">mini</span><span class="p">,</span> <span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">maxi</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">maxi</span><span class="p">,</span> <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">page</span><span class="p">:</span>
            <span class="n">page</span> <span class="o">=</span> <span class="n">step</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_range</span><span class="p">(</span><span class="n">mini</span><span class="p">,</span> <span class="n">maxi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_increments</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">page</span><span class="p">)</span>

        <span class="n">digits</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">step</span> <span class="ow">and</span> <span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">step</span><span class="p">)):</span>
            <span class="n">digits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">step</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_digits</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;value-changed&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_value_changed</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">tooltip</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">size_group</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_to_size_group</span><span class="p">(</span><span class="n">size_group</span><span class="p">)</span>

<div class="viewcode-block" id="SpinButton._on_value_changed"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SpinButton._on_value_changed">[docs]</a>    <span class="k">def</span> <span class="nf">_on_value_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;On value changed.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Remove source.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">get_value</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timer</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">GLib</span><span class="o">.</span><span class="n">SOURCE_REMOVE</span></div>

<div class="viewcode-block" id="SpinButton.on_value_changed"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SpinButton.on_value_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_value_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delayed apply.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timer</span><span class="p">:</span>
            <span class="n">GLib</span><span class="o">.</span><span class="n">source_remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_timer</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_timer</span> <span class="o">=</span> <span class="n">GLib</span><span class="o">.</span><span class="n">timeout_add</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_value_changed</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Keybinding"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Keybinding">[docs]</a><span class="k">class</span> <span class="nc">Keybinding</span><span class="p">(</span><span class="n">SettingsWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A widget to set and store a keybinding into a preference.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    bind_dir : Gio.SettingsBindFlags, None</span>
<span class="sd">        See :any:`JSONSettingsBackend`.</span>
<span class="sd">    content_widget : Gtk.Frame</span>
<span class="sd">        The main widget that will be used to represent a setting value.</span>
<span class="sd">    label : SettingsWidgets.SettingsLabel</span>
<span class="sd">        The label widget.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bind_dir</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">num_bind</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size_group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dep_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            The label text.</span>
<span class="sd">        num_bind : int, optional</span>
<span class="sd">            Number of keybinding widgets.</span>
<span class="sd">        size_group : None, optional</span>
<span class="sd">            A ``Gtk.SizeGroup``.</span>
<span class="sd">        dep_key : None, optional</span>
<span class="sd">            See :any:`SettingsWidget.set_dep_key`.</span>
<span class="sd">        tooltip : str, optional</span>
<span class="sd">            Widget tooltip text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dep_key</span><span class="o">=</span><span class="n">dep_key</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_bind</span> <span class="o">=</span> <span class="n">num_bind</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">SettingsLabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_kb_buttons</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">shadow_type</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">ShadowType</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">valign</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
        <span class="n">box</span> <span class="o">=</span> <span class="n">BaseGrid</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Orientation</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_bind</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">box</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Orientation</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">))</span>
            <span class="n">kb</span> <span class="o">=</span> <span class="n">ButtonKeybinding</span><span class="p">()</span>
            <span class="n">kb</span><span class="o">.</span><span class="n">set_size_request</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">kb</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;accel-edited&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_kb_changed</span><span class="p">)</span>
            <span class="n">kb</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;accel-cleared&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_kb_changed</span><span class="p">)</span>
            <span class="n">box</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">kb</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_kb_buttons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">tooltip</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">size_group</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_to_size_group</span><span class="p">(</span><span class="n">size_group</span><span class="p">)</span>

<div class="viewcode-block" id="Keybinding._on_kb_changed"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Keybinding._on_kb_changed">[docs]</a>    <span class="k">def</span> <span class="nf">_on_kb_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;On keybinding changed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bindings</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_bind</span><span class="p">):</span>
            <span class="n">string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kb_buttons</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">get_accel_string</span><span class="p">()</span>
            <span class="n">bindings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bindings</span><span class="p">))</span></div>

<div class="viewcode-block" id="Keybinding.on_setting_changed"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Keybinding.on_setting_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_setting_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :any:`JSONSettingsBackend.on_setting_changed`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>
        <span class="n">bindings</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bindings</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_bind</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_kb_buttons</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">set_accel_string</span><span class="p">(</span><span class="n">bindings</span><span class="p">[</span><span class="n">x</span><span class="p">])</span></div>

<div class="viewcode-block" id="Keybinding.connect_widget_handlers"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.Keybinding.connect_widget_handlers">[docs]</a>    <span class="k">def</span> <span class="nf">connect_widget_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :any:`JSONSettingsBackend.connect_widget_handlers`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div></div>


<div class="viewcode-block" id="KeybindingWithOptions"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.KeybindingWithOptions">[docs]</a><span class="k">class</span> <span class="nc">KeybindingWithOptions</span><span class="p">(</span><span class="n">SettingsWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A widget to choose a keybinding and bind it to an option from a combo box.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    bind_dir : Gio.SettingsBindFlags, None</span>
<span class="sd">        See :any:`JSONSettingsBackend`.</span>
<span class="sd">    content_widget : BaseGrid</span>
<span class="sd">        The main widget that will be used to represent a setting value.</span>
<span class="sd">    label : SettingsWidgets.SettingsLabel</span>
<span class="sd">        The label widget.</span>
<span class="sd">    model : Gtk.ListStore</span>
<span class="sd">        The model used as storage by this widget.</span>
<span class="sd">    value : str, int, float</span>
<span class="sd">        The preference stored value used to set the current combo box item.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bind_dir</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">[],</span> <span class="n">valtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">size_group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dep_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            The label text.</span>
<span class="sd">        options : list, optional</span>
<span class="sd">            A list of tuples of two elements representing the options used to build</span>
<span class="sd">            a :any:`ComboBox` widget and its derivatives.</span>
<span class="sd">        valtype : None, optional</span>
<span class="sd">            The type used to coerce a specific option type.</span>
<span class="sd">        size_group : None, optional</span>
<span class="sd">            A ``Gtk.SizeGroup``.</span>
<span class="sd">        dep_key : None, optional</span>
<span class="sd">            See :any:`SettingsWidget.set_dep_key`.</span>
<span class="sd">        tooltip : str, optional</span>
<span class="sd">            Widget tooltip text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dep_key</span><span class="o">=</span><span class="n">dep_key</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">SettingsLabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_valtype</span> <span class="o">=</span> <span class="n">valtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_option_map</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span> <span class="o">=</span> <span class="n">BaseGrid</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Orientation</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">kb_box</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">shadow_type</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">ShadowType</span><span class="o">.</span><span class="n">IN</span><span class="p">)</span>
        <span class="n">kb_box</span><span class="o">.</span><span class="n">set_valign</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_kb_button</span> <span class="o">=</span> <span class="n">ButtonKeybinding</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_kb_button</span><span class="o">.</span><span class="n">set_size_request</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">kb_box</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_kb_button</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_combo_button</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ComboBox</span><span class="p">()</span>
        <span class="n">renderer_text</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">CellRendererText</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_combo_button</span><span class="o">.</span><span class="n">pack_start</span><span class="p">(</span><span class="n">renderer_text</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_combo_button</span><span class="o">.</span><span class="n">add_attribute</span><span class="p">(</span><span class="n">renderer_text</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_combo_button</span><span class="o">.</span><span class="n">set_valign</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">kb_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Orientation</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_combo_button</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_options</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">tooltip</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">size_group</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_to_size_group</span><span class="p">(</span><span class="n">size_group</span><span class="p">)</span>

<div class="viewcode-block" id="KeybindingWithOptions._on_kb_changed"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.KeybindingWithOptions._on_kb_changed">[docs]</a>    <span class="k">def</span> <span class="nf">_on_kb_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;On keybinding changed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">kb</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">kb</span><span class="p">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># noqa</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_kb_button</span><span class="o">.</span><span class="n">get_accel_string</span><span class="p">()</span><span class="si">}</span><span class="s2">::</span><span class="si">{</span><span class="n">opt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="KeybindingWithOptions._on_combo_value_changed"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.KeybindingWithOptions._on_combo_value_changed">[docs]</a>    <span class="k">def</span> <span class="nf">_on_combo_value_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combo</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;On combo box changed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        combo : Gtk.ComboBox</span>
<span class="sd">            The widget combo box.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tree_iter</span> <span class="o">=</span> <span class="n">combo</span><span class="o">.</span><span class="n">get_active_iter</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">tree_iter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_kb_button</span><span class="o">.</span><span class="n">get_accel_string</span><span class="p">()</span><span class="si">}</span><span class="s2">::</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="n">tree_iter</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="KeybindingWithOptions._set_options"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.KeybindingWithOptions._set_options">[docs]</a>    <span class="k">def</span> <span class="nf">_set_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set options.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        options : list</span>
<span class="sd">            See :any:`ComboBox` ``options`` argument.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">var_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valtype</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">var_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ListStore</span><span class="p">(</span><span class="n">var_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_option_map</span><span class="p">[</span><span class="n">var_type</span><span class="p">(</span><span class="n">option</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">[</span><span class="n">var_type</span><span class="p">(</span><span class="n">option</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">option</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_combo_button</span><span class="o">.</span><span class="n">set_model</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_combo_button</span><span class="o">.</span><span class="n">set_id_column</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="KeybindingWithOptions.on_setting_changed"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.KeybindingWithOptions.on_setting_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_setting_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :any:`JSONSettingsBackend.on_setting_changed`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">binding</span><span class="p">,</span> <span class="n">option</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">binding</span><span class="p">,</span> <span class="n">option</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_kb_button</span><span class="o">.</span><span class="n">set_accel_string</span><span class="p">(</span><span class="n">binding</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_combo_button</span><span class="o">.</span><span class="n">set_active_iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_option_map</span><span class="p">[</span><span class="n">option</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_combo_button</span><span class="o">.</span><span class="n">set_active_iter</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="KeybindingWithOptions.connect_widget_handlers"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.KeybindingWithOptions.connect_widget_handlers">[docs]</a>    <span class="k">def</span> <span class="nf">connect_widget_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :any:`JSONSettingsBackend.connect_widget_handlers`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_kb_button</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;accel-edited&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_kb_changed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_kb_button</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;accel-cleared&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_kb_changed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_combo_button</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;changed&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_combo_value_changed</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="StringsList"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.StringsList">[docs]</a><span class="k">class</span> <span class="nc">StringsList</span><span class="p">(</span><span class="n">SettingsWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Strings list widget.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    bind_dir : Gio.SettingsBindFlags, None</span>
<span class="sd">        See :any:`JSONSettingsBackend`.</span>
<span class="sd">    content_widget : Gtk.Button</span>
<span class="sd">        The content widget.</span>
<span class="sd">    dialog_height : int</span>
<span class="sd">        Height of the dialog tied to the widget.</span>
<span class="sd">    dialog_width : int</span>
<span class="sd">        Width of the dialog tied to the widget.</span>
<span class="sd">    label : str</span>
<span class="sd">        The widget label.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bind_dir</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_columns</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;STRING&quot;</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">dep_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            Widget label text.</span>
<span class="sd">        dep_key : None, optional</span>
<span class="sd">            Dependency key/s.</span>
<span class="sd">        tooltip : str, optional</span>
<span class="sd">            Widget tooltip text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dep_key</span><span class="o">=</span><span class="n">dep_key</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialog_width</span> <span class="o">=</span> <span class="mi">400</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialog_height</span> <span class="o">=</span> <span class="mi">500</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">valign</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_changed_pref_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pref_key</span><span class="si">}</span><span class="s2">_changed&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changed_pref_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">settings</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_changed_pref_key</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">tooltip</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_strings_store</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ListStore</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_strings_store</span><span class="o">.</span><span class="n">set_column_types</span><span class="p">([</span><span class="n">GObject</span><span class="o">.</span><span class="n">TYPE_STRING</span><span class="p">])</span>

<div class="viewcode-block" id="StringsList._open_strings_list"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.StringsList._open_strings_list">[docs]</a>    <span class="k">def</span> <span class="nf">_open_strings_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open applications list.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">IntelligentGtkDialog</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">transient_for</span><span class="o">=</span><span class="n">get_toplevel_window</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
            <span class="n">use_header_bar</span><span class="o">=</span><span class="n">get_global</span><span class="p">(</span><span class="s2">&quot;USE_HEADER_BARS_ON_DIALOGS&quot;</span><span class="p">),</span>
            <span class="n">title</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Strings list&quot;</span><span class="p">),</span>
            <span class="n">flags</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">DialogFlags</span><span class="o">.</span><span class="n">MODAL</span> <span class="o">|</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">DialogFlags</span><span class="o">.</span><span class="n">DESTROY_WITH_PARENT</span>
        <span class="p">)</span>

        <span class="n">content_area</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">get_content_area</span><span class="p">()</span>
        <span class="n">content_area_grid</span> <span class="o">=</span> <span class="n">BaseGrid</span><span class="p">()</span>
        <span class="n">content_area</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">content_area_grid</span><span class="p">)</span>

        <span class="n">entry</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Entry</span><span class="p">()</span>
        <span class="n">entry</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">add_string</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Add string.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            widget : Gtk.Entry</span>
<span class="sd">                The widget to get the value from.</span>
<span class="sd">            self : SettingsWidget</span>
<span class="sd">                Reference to :any:`StringsList`.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_string_to_list</span><span class="p">(</span><span class="n">widget</span><span class="o">.</span><span class="n">get_text</span><span class="p">())</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="n">entry</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;activate&quot;</span><span class="p">,</span> <span class="n">add_string</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">content_area_grid</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">scrolled</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ScrolledWindow</span><span class="p">(</span><span class="n">hadjustment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vadjustment</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="c1"># Mark for deletion on EOL. Gtk4</span>
        <span class="c1"># Stop using set_shadow_type and set the boolean property has-frame.</span>
        <span class="n">scrolled</span><span class="o">.</span><span class="n">set_shadow_type</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">ShadowType</span><span class="o">.</span><span class="n">IN</span><span class="p">)</span>
        <span class="n">scrolled</span><span class="o">.</span><span class="n">set_policy</span><span class="p">(</span><span class="n">hscrollbar_policy</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">NEVER</span><span class="p">,</span>
                            <span class="n">vscrollbar_policy</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">AUTOMATIC</span><span class="p">)</span>
        <span class="n">content_area_grid</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">scrolled</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">tree_view</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">TreeView</span><span class="p">()</span>
        <span class="n">tree_view</span><span class="o">.</span><span class="n">set_model</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_strings_store</span><span class="p">)</span>
        <span class="n">tree_view</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s2">&quot;expand&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">tree_view</span><span class="o">.</span><span class="n">get_selection</span><span class="p">()</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">SelectionMode</span><span class="o">.</span><span class="n">MULTIPLE</span><span class="p">)</span>

        <span class="n">column</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">TreeViewColumn</span><span class="p">()</span>
        <span class="n">column</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Entries&quot;</span><span class="p">))</span>
        <span class="n">column</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s2">&quot;expand&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">column</span><span class="o">.</span><span class="n">set_sort_column_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">[</span><span class="s2">&quot;STRING&quot;</span><span class="p">])</span>

        <span class="n">renderer</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">CellRendererText</span><span class="p">()</span>
        <span class="n">column</span><span class="o">.</span><span class="n">pack_start</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">column</span><span class="o">.</span><span class="n">add_attribute</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">[</span><span class="s2">&quot;STRING&quot;</span><span class="p">])</span>
        <span class="n">tree_view</span><span class="o">.</span><span class="n">append_column</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>

        <span class="n">scrolled</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tree_view</span><span class="p">)</span>

        <span class="n">toolbar</span> <span class="o">=</span> <span class="n">BaseGrid</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Orientation</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="n">toolbar</span><span class="o">.</span><span class="n">set_halign</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">FILL</span><span class="p">)</span>
        <span class="n">toolbar</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Mark for deletion on EOL. Gtk4</span>
        <span class="c1"># Replace Gtk.StyleContext.add_class with Gtk.Widget.add_css_class.</span>
        <span class="n">toolbar</span><span class="o">.</span><span class="n">get_style_context</span><span class="p">()</span><span class="o">.</span><span class="n">add_class</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">STYLE_CLASS_INLINE_TOOLBAR</span><span class="p">)</span>
        <span class="n">buttons_box</span> <span class="o">=</span> <span class="n">BaseGrid</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Orientation</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="n">buttons_box</span><span class="o">.</span><span class="n">set_halign</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
        <span class="n">buttons_box</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">toolbar</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">buttons_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">content_area_grid</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">toolbar</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">del_button</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new_from_icon_name</span><span class="p">(</span>
            <span class="s2">&quot;edit-delete-symbolic&quot;</span><span class="p">,</span>
            <span class="n">Gtk</span><span class="o">.</span><span class="n">IconSize</span><span class="o">.</span><span class="n">LARGE_TOOLBAR</span>
        <span class="p">))</span>
        <span class="n">del_button</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Remove selected entries&quot;</span><span class="p">))</span>
        <span class="n">del_button</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;clicked&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete_selected_strings</span><span class="p">,</span> <span class="n">tree_view</span><span class="p">)</span>
        <span class="n">buttons_box</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">del_button</span><span class="p">)</span>

        <span class="n">help_button</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new_from_icon_name</span><span class="p">(</span>
            <span class="s2">&quot;dialog-information-symbolic&quot;</span><span class="p">,</span>
            <span class="n">Gtk</span><span class="o">.</span><span class="n">IconSize</span><span class="o">.</span><span class="n">LARGE_TOOLBAR</span>
        <span class="p">))</span>
        <span class="n">help_button</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Help&quot;</span><span class="p">))</span>
        <span class="n">help_button</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;clicked&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_display_help</span><span class="p">,</span> <span class="n">dialog</span><span class="p">)</span>
        <span class="n">buttons_box</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">help_button</span><span class="p">)</span>

        <span class="n">selection</span> <span class="o">=</span> <span class="n">tree_view</span><span class="o">.</span><span class="n">get_selection</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">set_del_button_sensitive</span><span class="p">(</span><span class="n">sel</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Set delete button sensitivity.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            sel : Gtk.TreeSelection</span>
<span class="sd">                THe selection containing the selected entries.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">del_button</span><span class="o">.</span><span class="n">set_sensitive</span><span class="p">(</span><span class="n">sel</span><span class="o">.</span><span class="n">count_selected_rows</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">selection</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;changed&quot;</span><span class="p">,</span> <span class="n">set_del_button_sensitive</span><span class="p">)</span>
        <span class="n">del_button</span><span class="o">.</span><span class="n">set_sensitive</span><span class="p">(</span><span class="n">selection</span><span class="o">.</span><span class="n">count_selected_rows</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_strings_list</span><span class="p">()</span>

        <span class="n">content_area</span><span class="o">.</span><span class="n">show_all</span><span class="p">()</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="n">dialog</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_list_changed</span><span class="p">()</span></div>

<div class="viewcode-block" id="StringsList._display_help"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.StringsList._display_help">[docs]</a>    <span class="k">def</span> <span class="nf">_display_help</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">dialog</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Display help message.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        widget : Gtk.Button</span>
<span class="sd">            The help button.</span>
<span class="sd">        dialog : IntelligentGtkDialog</span>
<span class="sd">            The dialog to use in the ``transient_for`` parameter of the message dialog that will be displayed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Duplicated entries will be automatically removed.&quot;</span><span class="p">),</span>
            <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Entries will be also sorted alphabetically.&quot;</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">display_message_dialog</span><span class="p">(</span><span class="n">dialog</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Basic information&quot;</span><span class="p">),</span> <span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="StringsList._populate_strings_list"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.StringsList._populate_strings_list">[docs]</a>    <span class="k">def</span> <span class="nf">_populate_strings_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Populate applications list.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_strings_store</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="c1"># NOTE: list(set()) in case that there are duplicated entries added externally.</span>
        <span class="n">current_strings</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">()))</span>

        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">current_strings</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_string_to_list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="c1"># The following line auto sorts the list at start up!!! Finally!!!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_strings_store</span><span class="o">.</span><span class="n">set_sort_column_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">[</span><span class="s2">&quot;STRING&quot;</span><span class="p">],</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">SortType</span><span class="o">.</span><span class="n">ASCENDING</span><span class="p">)</span></div>

<div class="viewcode-block" id="StringsList._add_string_to_list"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.StringsList._add_string_to_list">[docs]</a>    <span class="k">def</span> <span class="nf">_add_string_to_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add string to list.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : str</span>
<span class="sd">            A newly added string to add to the strings list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">iter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strings_store</span><span class="o">.</span><span class="n">append</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_strings_store</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">iter</span><span class="p">,</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">[</span><span class="s2">&quot;STRING&quot;</span><span class="p">]</span>
        <span class="p">],</span> <span class="p">[</span>
            <span class="n">value</span>
        <span class="p">])</span></div>

<div class="viewcode-block" id="StringsList._delete_selected_strings"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.StringsList._delete_selected_strings">[docs]</a>    <span class="k">def</span> <span class="nf">_delete_selected_strings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">tree</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete selected applications.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        widget : Gtk.Button</span>
<span class="sd">            A ``Gtk.Button``.</span>
<span class="sd">        tree : Gtk.TreeView</span>
<span class="sd">            A ``Gtk.TreeView``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">get_selection</span><span class="p">()</span>
        <span class="n">tree_model</span><span class="p">,</span> <span class="n">paths</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">get_selected_rows</span><span class="p">()</span>

        <span class="c1"># Iterate in reverse so the right rows are removed.</span>
        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
            <span class="n">tree_iter</span> <span class="o">=</span> <span class="n">tree_model</span><span class="o">.</span><span class="n">get_iter</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">tree_model</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tree_iter</span><span class="p">)</span></div>

<div class="viewcode-block" id="StringsList._list_changed"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.StringsList._list_changed">[docs]</a>    <span class="k">def</span> <span class="nf">_list_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;List changed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># NOTE: Use of set() to avoid storing duplicates.</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strings_store</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">[</span><span class="s2">&quot;STRING&quot;</span><span class="p">]])</span>

        <span class="c1"># NOTE: Do not unnecessarily save data if the list of strings hasn&#39;t changed.</span>
        <span class="k">if</span> <span class="n">data</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changed_pref_key</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_changed_pref_key</span><span class="p">,</span>
                    <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_changed_pref_key</span><span class="p">))</span></div>

<div class="viewcode-block" id="StringsList.on_setting_changed"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.StringsList.on_setting_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_setting_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :any:`JSONSettingsBackend.on_setting_changed`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_strings_list</span><span class="p">()</span></div>

<div class="viewcode-block" id="StringsList.connect_widget_handlers"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.StringsList.connect_widget_handlers">[docs]</a>    <span class="k">def</span> <span class="nf">connect_widget_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :any:`JSONSettingsBackend.connect_widget_handlers`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;clicked&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_strings_list</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SoundFileChooser"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SoundFileChooser">[docs]</a><span class="k">class</span> <span class="nc">SoundFileChooser</span><span class="p">(</span><span class="n">SettingsWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sound file chooser widget.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    bind_dir : Gio.SettingsBindFlags, None</span>
<span class="sd">        See :any:`JSONSettingsBackend`.</span>
<span class="sd">    content_widget : BaseGrid</span>
<span class="sd">        The main widget that will be used to represent a setting value.</span>
<span class="sd">    label : str</span>
<span class="sd">        The label widget.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bind_dir</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">event_sounds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size_group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dep_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            The label widget.</span>
<span class="sd">        event_sounds : bool, optional</span>
<span class="sd">            If True, only wav and ogg sound files will be filtered in</span>
<span class="sd">            the file chooser dialog. If set to False, all sound files will be displayed.</span>
<span class="sd">        size_group : None, optional</span>
<span class="sd">            A ``Gtk.SizeGroup``.</span>
<span class="sd">        dep_key : None, optional</span>
<span class="sd">            Dependency key/s.</span>
<span class="sd">        tooltip : str, optional</span>
<span class="sd">            Widget tooltip text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dep_key</span><span class="o">=</span><span class="n">dep_key</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_proxy</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_event_sounds</span> <span class="o">=</span> <span class="n">event_sounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">SettingsLabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span> <span class="o">=</span> <span class="n">BaseGrid</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Orientation</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="c1"># Mark for deletion on EOL. Gtk4</span>
        <span class="c1"># Replace Gtk.StyleContext.add_class with Gtk.Widget.add_css_class.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">get_style_context</span><span class="p">()</span><span class="o">.</span><span class="n">add_class</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">STYLE_CLASS_LINKED</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_button</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new_from_icon_name</span><span class="p">(</span>
            <span class="s2">&quot;edit-clear-symbolic&quot;</span><span class="p">,</span>
            <span class="n">Gtk</span><span class="o">.</span><span class="n">IconSize</span><span class="o">.</span><span class="n">BUTTON</span>
        <span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_button</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Clear sound&quot;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_file_picker_button</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Button</span><span class="p">()</span>

        <span class="n">button_content</span> <span class="o">=</span> <span class="n">BaseGrid</span><span class="p">()</span>
        <span class="n">button_content</span><span class="o">.</span><span class="n">set_spacing</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file_picker_button</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">button_content</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_button_label</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Label</span><span class="p">()</span>
        <span class="n">button_content</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">icon_name</span><span class="o">=</span><span class="s2">&quot;sound&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">button_content</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_button_label</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_play_button</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Button</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_play_button</span><span class="o">.</span><span class="n">set_image</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new_from_icon_name</span><span class="p">(</span>
            <span class="s2">&quot;media-playback-start-symbolic&quot;</span><span class="p">,</span>
            <span class="n">Gtk</span><span class="o">.</span><span class="n">IconSize</span><span class="o">.</span><span class="n">BUTTON</span>
        <span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_clear_button</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_picker_button</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_play_button</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_widget</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">Gio</span><span class="o">.</span><span class="n">DBusProxy</span><span class="o">.</span><span class="n">new_for_bus</span><span class="p">(</span><span class="n">Gio</span><span class="o">.</span><span class="n">BusType</span><span class="o">.</span><span class="n">SESSION</span><span class="p">,</span> <span class="n">Gio</span><span class="o">.</span><span class="n">DBusProxyFlags</span><span class="o">.</span><span class="n">NONE</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span>
                                      <span class="s2">&quot;org.cinnamon.SettingsDaemon.Sound&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;/org/cinnamon/SettingsDaemon/Sound&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;org.cinnamon.SettingsDaemon.Sound&quot;</span><span class="p">,</span>
                                      <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_proxy_ready</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">GLib</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_proxy</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_play_button</span><span class="o">.</span><span class="n">set_sensitive</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">tooltip</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">size_group</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_to_size_group</span><span class="p">(</span><span class="n">size_group</span><span class="p">)</span>

<div class="viewcode-block" id="SoundFileChooser._on_clear_button_clicked"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SoundFileChooser._on_clear_button_clicked">[docs]</a>    <span class="k">def</span> <span class="nf">_on_clear_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;On clear button clicked.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_button_label</span><span class="p">()</span></div>

<div class="viewcode-block" id="SoundFileChooser._on_proxy_ready"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SoundFileChooser._on_proxy_ready">[docs]</a>    <span class="k">def</span> <span class="nf">_on_proxy_ready</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;On proxy ready.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        object : GObject.Object</span>
<span class="sd">            The object the asynchronous operation was started with.</span>
<span class="sd">        result : Gio.AsyncResult</span>
<span class="sd">            A :any:`Gio.AsyncResult`.</span>
<span class="sd">        data : None, optional</span>
<span class="sd">            User data passed to the callback.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_proxy</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">DBusProxy</span><span class="o">.</span><span class="n">new_for_bus_finish</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_button_label</span><span class="p">()</span></div>

<div class="viewcode-block" id="SoundFileChooser.on_play_clicked"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SoundFileChooser.on_play_clicked">[docs]</a>    <span class="k">def</span> <span class="nf">on_play_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;On play button clicked.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        widget : Gtk.Button</span>
<span class="sd">            The button that triggered this function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_proxy</span><span class="o">.</span><span class="n">PlaySoundFile</span><span class="p">(</span><span class="s2">&quot;(us)&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">())</span></div>

<div class="viewcode-block" id="SoundFileChooser.on_picker_clicked"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SoundFileChooser.on_picker_clicked">[docs]</a>    <span class="k">def</span> <span class="nf">on_picker_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;On picker clicked.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        widget : Gtk.Button</span>
<span class="sd">            The button that triggered this function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">FileChooserDialog</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">get_text</span><span class="p">(),</span>
            <span class="n">use_header_bar</span><span class="o">=</span><span class="n">get_global</span><span class="p">(</span><span class="s2">&quot;USE_HEADER_BARS_ON_DIALOGS&quot;</span><span class="p">),</span>
            <span class="n">action</span><span class="o">=</span><span class="n">Gtk</span><span class="o">.</span><span class="n">FileChooserAction</span><span class="o">.</span><span class="n">OPEN</span><span class="p">,</span>
            <span class="n">transient_for</span><span class="o">=</span><span class="n">get_toplevel_window</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
            <span class="n">buttons</span><span class="o">=</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;_Cancel&quot;</span><span class="p">),</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">CANCEL</span><span class="p">,</span>
                     <span class="n">_</span><span class="p">(</span><span class="s2">&quot;_Open&quot;</span><span class="p">),</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">ACCEPT</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">()):</span>
            <span class="n">dialog</span><span class="o">.</span><span class="n">set_filename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dialog</span><span class="o">.</span><span class="n">set_current_folder</span><span class="p">(</span><span class="s2">&quot;/usr/share/sounds&quot;</span><span class="p">)</span>

        <span class="n">sound_filter</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">FileFilter</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_event_sounds</span><span class="p">:</span>
            <span class="n">sound_filter</span><span class="o">.</span><span class="n">add_mime_type</span><span class="p">(</span><span class="s2">&quot;audio/x-wav&quot;</span><span class="p">)</span>
            <span class="n">sound_filter</span><span class="o">.</span><span class="n">add_mime_type</span><span class="p">(</span><span class="s2">&quot;audio/x-vorbis+ogg&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sound_filter</span><span class="o">.</span><span class="n">add_mime_type</span><span class="p">(</span><span class="s2">&quot;audio/*&quot;</span><span class="p">)</span>

        <span class="n">sound_filter</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Sound files&quot;</span><span class="p">))</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="n">sound_filter</span><span class="p">)</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">response</span> <span class="o">==</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">ACCEPT</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">get_filename</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_button_label</span><span class="p">()</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span></div>

<div class="viewcode-block" id="SoundFileChooser.update_button_label"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SoundFileChooser.update_button_label">[docs]</a>    <span class="k">def</span> <span class="nf">update_button_label</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update button label.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">absolute_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">absolute_path</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_button_label</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">GLib</span><span class="o">.</span><span class="n">path_get_basename</span><span class="p">(</span><span class="n">absolute_path</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_file_picker_button</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span><span class="n">absolute_path</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_play_button</span><span class="o">.</span><span class="n">set_sensitive</span><span class="p">(</span><span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_proxy</span><span class="p">))</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">GLib</span><span class="o">.</span><span class="n">file_test</span><span class="p">(</span><span class="n">absolute_path</span><span class="p">,</span> <span class="n">GLib</span><span class="o">.</span><span class="n">FileTest</span><span class="o">.</span><span class="n">EXISTS</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_file_picker_button</span><span class="o">.</span><span class="n">set_tooltip_text</span><span class="p">(</span>
                    <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Non-existent file&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">absolute_path</span><span class="p">)</span>
                <span class="c1"># Mark for deletion on EOL. Gtk4</span>
                <span class="c1"># Replace Gtk.StyleContext.add_class with Gtk.Widget.add_css_class.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_button_label</span><span class="o">.</span><span class="n">get_style_context</span><span class="p">()</span><span class="o">.</span><span class="n">add_class</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">STYLE_CLASS_ERROR</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_play_button</span><span class="o">.</span><span class="n">set_sensitive</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_button_label</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;No sound&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_play_button</span><span class="o">.</span><span class="n">set_sensitive</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="SoundFileChooser.on_setting_changed"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SoundFileChooser.on_setting_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_setting_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :any:`JSONSettingsBackend.on_setting_changed`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_button_label</span><span class="p">()</span></div>

<div class="viewcode-block" id="SoundFileChooser.connect_widget_handlers"><a class="viewcode-back" href="../../modules/xlets_settings/xlets_settings.SettingsWidgets.html#xlets_settings.JsonSettingsWidgets.SoundFileChooser.connect_widget_handlers">[docs]</a>    <span class="k">def</span> <span class="nf">connect_widget_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :any:`JSONSettingsBackend.connect_widget_handlers`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_button</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;clicked&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_clear_button_clicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_play_button</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;clicked&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_play_clicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file_picker_button</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;clicked&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_picker_clicked</span><span class="p">)</span></div></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2022, Odyseus..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://gitlab.com/Odyseus/sphinx_rtd_theme_mod">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>

        </div>
      </div>

      <a id="to-top-of-page" href="#top">
        <i class="fa fa-chevron-circle-up"></i>
      </a>

    </section>
  </div>

  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>